<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø¶Ø¨Ø· Ø§Ù„ÙˆØ«Ø§Ø¦Ù‚ Ø§Ù„Ø°ÙƒÙŠ - Ø¬Ø§Ù…Ø¹Ø© Ø£Ø³ÙŠÙˆØ·</title>
    <style>
        /* Ø§Ù„Ø®Ø·ÙˆØ· ÙˆØ§Ù„Ø£Ù„ÙˆØ§Ù† Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© */
        @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap');
        :root {
            --primary-color: #004a99; /* Ø£Ø²Ø±Ù‚ Ø§Ù„Ø¬Ø§Ù…Ø¹Ø© */
            --secondary-color: #f7b731; /* Ù„ÙˆÙ† ØªÙ…ÙŠØ² */
            --background-color: #f8f9fa;
            --text-color: #333;
            --border-color: #ddd;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Cairo', sans-serif;
        }

        body {
            background-color: var(--background-color);
            color: var(--text-color);
            line-height: 1.6;
            padding-bottom: 95px; /* Ù…Ø³Ø§Ø­Ø© Ø£ÙƒØ¨Ø± Ù„Ù„ÙÙˆØªØ± Ø§Ù„Ø«Ø§Ø¨Øª */
        }

        /* Ø±Ø£Ø³ Ø§Ù„ØµÙØ­Ø© (Ø§Ù„Ù‡ÙŠØ¯Ø±) */
        .header {
            background-color: var(--primary-color);
            color: white;
            padding: 15px 40px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .header h1 {
            font-size: 1.8em;
            display: flex;
            align-items: center;
            gap: 15px; /* Ø§Ù„Ù…Ø³Ø§ÙØ© Ø¨ÙŠÙ† Ø§Ù„Ø´Ø¹Ø§Ø±Ø§Øª ÙˆØ§Ù„Ø¹Ù†ÙˆØ§Ù† */
        }

        /* ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ø´Ø¹Ø§Ø± ÙˆØ§Ù„Ø¹Ù„Ù… ÙˆØ§Ù„Ø±Ø¤ÙŠØ© */
        .header-logo {
            line-height: 1;
        }
        
        .flag-emblem {
            background-color: #d63333; /* Ù„ÙˆÙ† Ø§Ù„Ø¹Ù„Ù… Ø§Ù„Ø£Ø­Ù…Ø± */
            color: white;
            font-size: 2.2em;
            padding: 5px 10px;
            border-radius: 5px;
            font-weight: 900;
        }
        
        .vision-emblem {
            background-color: var(--secondary-color); /* Ù„ÙˆÙ† Ø§Ù„Ø±Ø¤ÙŠØ© (Ø£ØµÙØ±/Ø°Ù‡Ø¨ÙŠ) */
            color: var(--primary-color);
            padding: 5px 8px;
            font-size: 1.1em;
            font-weight: bold;
            border-radius: 5px;
        }

        .icon {
            font-size: 2.2em;
            color: var(--secondary-color);
        }
        
        .header-user-section {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-right: auto;
        }

        .user-avatar {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--secondary-color), #ffd700);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5em;
            color: var(--primary-color);
            border: 2px solid white;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
        }

        .user-info {
            display: flex;
            flex-direction: column;
            align-items: flex-end;
        }

        .user-name {
            font-weight: bold;
            font-size: 1em;
        }

        .user-role {
            font-size: 0.85em;
            color: #ffda79;
            margin-top: 2px;
        }

        /* Ø²Ø± ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ ÙÙŠ Ø£Ù‚ØµÙ‰ Ø§Ù„ÙŠØ³Ø§Ø± */
        .header-controls {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-left: auto; /* ÙŠØ¯ÙØ¹ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ù„Ù„ÙŠÙ…ÙŠÙ† */
        }
        
        /* ØªØµÙ…ÙŠÙ… Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø²ÙˆØ§Ø± */
        .visitor-counter {
            font-size: 0.9em; 
            padding: 4px 8px; 
            background-color: var(--secondary-color); 
            color: var(--primary-color); 
            border-radius: 4px; 
            display: flex; 
            align-items: center; 
            gap: 5px;
            font-weight: bold;
        }

        /* Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ */
        .container {
            width: 90%;
            max-width: 1200px;
            margin: 30px auto;
            padding: 20px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.05);
        }

        /* === Ø´Ø§Ø´Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© === */
        #login-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: var(--background-color);
            display: flex;
            flex-direction: row; /* Ù„ØªÙ‚Ø³ÙŠÙ… Ø§Ù„Ø´Ø§Ø´Ø© */
            justify-content: center;
            align-items: center;
            gap: 30px; /* Ø§Ù„Ù…Ø³Ø§ÙØ© Ø¨ÙŠÙ† Ø§Ù„Ø¬Ø²Ø¦ÙŠÙ† */
            padding: 20px;
            z-index: 1000;
        }
        
        .login-box {
            background: white;
            padding: 40px;
            border-radius: 10px;
            box-shadow: 0 0 25px rgba(0, 0, 0, 0.15);
            width: 100%;
            max-width: 400px;
            text-align: center;
        }
        
        #preview-pane {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 0 25px rgba(0, 0, 0, 0.1);
            width: 100%;
            max-width: 550px;
            height: 600px; 
            text-align: center;
            border: 3px solid var(--secondary-color);
            overflow: hidden;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        @media (max-width: 992px) {
            #login-screen {
                flex-direction: column; 
                overflow-y: auto;
            }
            #preview-pane {
                height: 400px;
                max-width: 400px;
            }
        }
        
        #main-content {
            display: none; 
        }

        /* Ø¨Ø§Ù‚ÙŠ Ø§Ù„Ø³ØªØ§ÙŠÙ„Ø§Øª Ø§Ù„Ø®Ø§ØµØ© Ø¨Ø§Ù„Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯ */
        .form-section h2, .status-section h2 {
            color: var(--primary-color);
            border-bottom: 2px solid var(--secondary-color);
            padding-bottom: 10px;
            margin-bottom: 20px;
            font-size: 1.5em;
        }

        .form-group {
            margin-bottom: 20px;
            text-align: right;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
        }

        .form-group input[type="text"],
        .form-group input[type="password"],
        .form-group select,
        .form-group input[type="file"] {
            width: 100%;
            padding: 12px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            transition: border-color 0.3s;
        }
        
        @media print {
            .footer, .header {
                display: none;
            }
        }

        .form-group input:focus,
        .form-group select:focus {
            border-color: var(--primary-color);
            outline: none;
        }

        .submit-btn {
            background-color: var(--primary-color);
            color: white;
            padding: 12px 25px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 1.1em;
            transition: background-color 0.3s;
        }

        .submit-btn:hover {
            background-color: #003366;
        }

        /* Ø¬Ø¯ÙˆÙ„ Ø­Ø§Ù„Ø© Ø§Ù„Ø·Ù„Ø¨Ø§Øª */
        .status-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        .status-table th, .status-table td {
            padding: 12px;
            border: 1px solid var(--border-color);
            text-align: right;
        }

        .status-table th {
            background-color: #e9ecef;
            color: var(--primary-color);
        }

        .status-table tr:nth-child(even) {
            background-color: #f2f2f2;
        }
        
        /* New Style for Action Button */
        .status-table button {
            background: var(--secondary-color);
            color: var(--primary-color);
            border: 1px solid var(--secondary-color);
            padding: 5px 10px;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
            transition: opacity 0.3s;
        }
        
        .status-table button:disabled {
            background: #95a5a6;
            color: white;
            cursor: not-allowed;
            opacity: 0.6;
        }
        
        .status-table button:hover:not(:disabled) {
            opacity: 0.9;
        }

        .status-table .status-pending { color: #f39c12; font-weight: bold; }
        .status-table .status-approved { color: #2ecc71; font-weight: bold; }
        .status-table .status-printed { color: var(--primary-color); font-weight: bold; }
        .status-table .status-completed { color: #27ae60; font-weight: bold; }
        
        .status-table a {
            color: #17a2b8; 
            text-decoration: underline;
            font-size: 0.9em;
            margin-top: 5px;
            display: inline-block;
        }

        /* Ø£Ø²Ø±Ø§Ø± Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³ØªÙ†Ø¯Ø§Øª */
        .doc-actions {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
            margin-top: 5px;
        }
        
        .doc-actions button {
            padding: 4px 8px;
            font-size: 0.8em;
            border: none;
            border-radius: 3px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .download-btn {
            background: #3498db;
            color: white;
        }
        
        .download-btn:hover {
            background: #2980b9;
        }
        
        .replace-btn {
            background: #f39c12;
            color: white;
        }
        
        .replace-btn:hover {
            background: #e67e22;
        }
        
        .delete-btn {
            background: #e74c3c;
            color: white;
        }
        
        .delete-btn:hover {
            background: #c0392b;
        }

        .preview-btn {
            background: #9b59b6;
            color: white;
        }
        
        .preview-btn:hover {
            background: #8e44ad;
        }

        /* Ø§Ù„ÙÙˆØªØ± ÙˆØ²Ø± Ø§Ù„ØªØ²Ø§Ù…Ù† */
        .footer {
            position: fixed;
            bottom: 0;
            right: 0;
            left: 0;
            background-color: #333;
            color: white;
            padding: 10px 40px; 
            text-align: center;
            box-shadow: 0 -2px 5px rgba(0, 0, 0, 0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.9em;
            flex-wrap: wrap;
        }
        
        .footer-info {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
            text-align: right;
        }
        
        .footer-info p {
            margin: 2px 0;
        }

        .footer-info .support-note {
            color: #ffda79; 
            font-weight: bold;
            margin-top: 5px;
            border-top: 1px dashed #555;
            padding-top: 3px;
            width: 100%;
        }

        .support-phone {
            background: var(--secondary-color);
            color: var(--primary-color);
            padding: 4px 8px;
            border-radius: 4px;
            font-weight: bold;
            direction: ltr;
            display: inline-block;
            margin: 2px 0;
        }

        .sync-btn {
            background-color: var(--secondary-color);
            color: var(--primary-color);
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            transition: background-color 0.3s;
        }

        .sync-btn:hover {
            background-color: #ffc107;
        }

        /* === Ø§Ù„ØªØ­Ø³ÙŠÙ†Ø§Øª Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© === */
        
        /* Ù…Ø¤Ø«Ø±Ø§Øª Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ */
        .button, .form-control, .submit-btn, .sync-btn {
            transition: all 0.3s ease;
        }

        @media (prefers-reduced-motion: reduce) {
            * { transition: none !important; }
        }

        /* Ø´Ø§Ø´Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„ */
        .loading-spinner {
            display: none;
            text-align: center;
            padding: 20px;
        }

        .progress-bar {
            width: 100%;
            height: 6px;
            background: #f0f0f0;
            border-radius: 3px;
            overflow: hidden;
            margin: 10px 0;
        }

        .progress-fill {
            height: 100%;
            background: var(--secondary-color);
            transition: width 0.3s ease;
        }

        /* Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª */
        .notification {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            padding: 15px 25px;
            border-radius: 8px;
            color: white;
            z-index: 10000;
            animation: slideDown 0.3s ease;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }

        @keyframes slideDown {
            from { top: -100px; opacity: 0; }
            to { top: 20px; opacity: 1; }
        }

        .notification.success { background: #27ae60; }
        .notification.error { background: #e74c3c; }
        .notification.warning { background: #f39c12; }
        .notification.info { background: #3498db; }

        /* Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª */
        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            text-align: center;
            transition: transform 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
        }

        /* Ù‚Ø³Ù… Ø§Ù„ØªØµÙÙŠØ© */
        .filters-section {
            margin-bottom: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
            border: 1px solid var(--border-color);
        }

        .filters-container {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            align-items: center;
        }

        .search-input, .filter-select {
            padding: 10px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            flex: 1;
            min-width: 250px;
        }

        /* Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ­ÙƒÙ… */
        .logout-btn {
            background: #e74c3c;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
            margin-left: 15px; /* Ù…Ø³Ø§ÙØ© Ù…Ù† Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø§Ù„Ø£Ø®Ø±Ù‰ */
        }

        .logout-btn:hover {
            background: #c0392b;
        }

        .backup-btn {
            background: #9b59b6;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            margin-right: 10px;
            transition: background-color 0.3s;
        }

        .backup-btn:hover {
            background: #8e44ad;
        }

        /* Ø´Ø¨ÙƒØ© Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        /* Ø²Ø± Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªØ¹ÙŠÙŠÙ† */
        .reset-btn {
            background: #95a5a6;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .reset-btn:hover {
            background: #7f8c8d;
        }

        /* Ø´Ø¹Ø§Ø± Ø¬Ø§Ù…Ø¹Ø© Ø£Ø³ÙŠÙˆØ· */
        .university-logo {
            font-size: 1.2em;
            font-weight: bold;
            color: var(--secondary-color);
            margin-right: 10px;
        }

        /* Ø²Ø± Ø§Ù„Ø§ØªØµØ§Ù„ */
        .contact-btn {
            background: #27ae60;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
            text-decoration: none;
            display: inline-block;
        }

        .contact-btn:hover {
            background: #219653;
        }
        
        /* ØªØ­Ø°ÙŠØ± Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ© */
        .permission-warning {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            color: #856404;
            padding: 10px 15px;
            border-radius: 6px;
            margin: 10px 0;
            font-size: 0.9em;
        }
        
        /* Ø­Ù‚Ù„ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„ÙƒÙ„ÙŠØ© ÙÙŠ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ */
        .college-selection {
            display: none; /* Ù…Ø®ÙÙŠ Ø§ÙØªØ±Ø§Ø¶ÙŠØ§Ù‹ */
        }

        /* ØªØ­Ø³ÙŠÙ†Ø§Øª Ù„Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„ØµØºÙŠØ±Ø© */
        @media (max-width: 768px) {
            .header {
                padding: 15px 20px;
                flex-wrap: wrap;
            }
            
            .header h1 {
                font-size: 1.4em;
                order: 1;
                width: 100%;
                margin-bottom: 10px;
                justify-content: center;
            }
            
            .header-user-section {
                order: 2;
                width: 100%;
                justify-content: center;
                margin: 10px 0;
            }
            
            .header-controls {
                order: 3;
                width: 100%;
                justify-content: space-between;
            }
            
            .doc-actions {
                flex-direction: column;
                gap: 5px;
            }
        }

        /* Ù†Ø§ÙØ°Ø© Ø§Ø³ØªØ¨Ø¯Ø§Ù„ Ø§Ù„Ù…Ø³ØªÙ†Ø¯ */
        .replace-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 2000;
            justify-content: center;
            align-items: center;
        }
        
        .replace-modal-content {
            background: white;
            padding: 30px;
            border-radius: 10px;
            width: 90%;
            max-width: 500px;
            text-align: center;
        }
        
        .modal-buttons {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-top: 20px;
        }

        /* Ù†Ø§ÙØ°Ø© Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„Ù…Ø³ØªÙ†Ø¯ */
        .preview-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            z-index: 3000;
            justify-content: center;
            align-items: center;
        }
        
        .preview-modal-content {
            background: white;
            padding: 20px;
            border-radius: 10px;
            width: 90%;
            max-width: 800px;
            max-height: 90vh;
            overflow: auto;
        }
        
        .preview-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            border-bottom: 2px solid var(--primary-color);
            padding-bottom: 10px;
        }
        
        .preview-iframe {
            width: 100%;
            height: 500px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        
        .preview-actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
            justify-content: center;
        }
    </style>
</head>
<body>

    <div id="login-screen">
        
        <div class="login-box">
            <h2>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ - Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø¶Ø¨Ø· Ø§Ù„ÙˆØ«Ø§Ø¦Ù‚ Ø§Ù„Ø°ÙƒÙŠ</h2>
            <div class="university-logo">Ø¬Ø§Ù…Ø¹Ø© Ø£Ø³ÙŠÙˆØ·</div>
            <div class="form-group">
                <label for="login-username">Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…:</label>
                <input type="text" id="login-username" placeholder="Ù…Ø«Ø§Ù„: college_sec" required>
            </div>
            <div class="form-group">
                <label for="login-password">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±:</label>
                <input type="password" id="login-password" placeholder="123456" required>
            </div>
            
            <!-- Ø­Ù‚Ù„ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„ÙƒÙ„ÙŠØ© - ÙŠØ¸Ù‡Ø± ÙÙ‚Ø· Ù„Ù„Ø£Ù…Ù†Ø§Ø¡ ÙˆÙ…ÙˆØ¸ÙÙŠ Ø§Ù„ÙƒÙ„ÙŠØ§Øª -->
            <div id="college-selection" class="form-group college-selection">
                <label for="user-college">Ø§Ù„ÙƒÙ„ÙŠØ© / Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªØ§Ø¨Ø¹ Ù„Ù‡Ø§:</label>
                <select id="user-college">
                    <option value="">Ø§Ø®ØªØ± Ø§Ù„ÙƒÙ„ÙŠØ©/Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</option>
                    <optgroup label="=== Ø§Ù„ÙˆØ­Ø¯Ø§Øª Ø§Ù„Ø¥Ø¯Ø§Ø±ÙŠØ© ===">
                        <option value="Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¬ÙˆØ¯Ø© ÙˆØ§Ù„ØªÙ…ÙŠØ²">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¬ÙˆØ¯Ø© ÙˆØ§Ù„ØªÙ…ÙŠØ²</option>
                        <option value="Ø§Ù„Ø´Ø¤ÙˆÙ† Ø§Ù„Ø¥Ø¯Ø§Ø±ÙŠØ©">Ø§Ù„Ø´Ø¤ÙˆÙ† Ø§Ù„Ø¥Ø¯Ø§Ø±ÙŠØ©</option>
                        <option value="Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¹Ø§Ù…Ø© Ù„Ø´Ø¤ÙˆÙ† Ø§Ù„Ø·Ù„Ø§Ø¨">Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¹Ø§Ù…Ø© Ù„Ø´Ø¤ÙˆÙ† Ø§Ù„Ø·Ù„Ø§Ø¨</option>
                        <option value="Ø§Ù„Ù…ÙƒØªØ¨ Ø§Ù„ÙÙ†ÙŠ Ù„Ø±Ø¦ÙŠØ³ Ø§Ù„Ø¬Ø§Ù…Ø¹Ø©">Ø§Ù„Ù…ÙƒØªØ¨ Ø§Ù„ÙÙ†ÙŠ Ù„Ø±Ø¦ÙŠØ³ Ø§Ù„Ø¬Ø§Ù…Ø¹Ø©</option>
                        <option value="Ù‚Ø³Ù… Ø§Ù„Ø¬ÙˆØ¯Ø©">Ù‚Ø³Ù… Ø§Ù„Ø¬ÙˆØ¯Ø©</option>
                        <option value="Ù‚Ø³Ù… ØªÙƒØ§ÙØ¤ Ø§Ù„ÙØ±Øµ">Ù‚Ø³Ù… ØªÙƒØ§ÙØ¤ Ø§Ù„ÙØ±Øµ</option>
                        <option value="Ù‚Ø³Ù… Ø§Ù„ØªÙ…ÙŠØ²">Ù‚Ø³Ù… Ø§Ù„ØªÙ…ÙŠØ²</option>
                        <option value="Ù‚Ø³Ù… Ø§Ù„Ø¯Ø¹Ù… Ø§Ù„Ù„ÙˆØ¬Ø³ØªÙŠ">Ù‚Ø³Ù… Ø§Ù„Ø¯Ø¹Ù… Ø§Ù„Ù„ÙˆØ¬Ø³ØªÙŠ</option>
                        <option value="Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¹Ø§Ù…Ø© Ù„Ù†Ø¸Ù… Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª ÙˆØ§Ù„ØªØ­ÙˆÙ„ Ø§Ù„Ø±Ù‚Ù…ÙŠ">Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¹Ø§Ù…Ø© Ù„Ù†Ø¸Ù… Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª ÙˆØ§Ù„ØªØ­ÙˆÙ„ Ø§Ù„Ø±Ù‚Ù…ÙŠ</option>
                        <option value="Ù…Ø±ÙƒØ² ØªØ·ÙˆÙŠØ± Ù†Ø¸Ù… Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¥Ø¯Ø§Ø±ÙŠØ©">Ù…Ø±ÙƒØ² ØªØ·ÙˆÙŠØ± Ù†Ø¸Ù… Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¥Ø¯Ø§Ø±ÙŠØ©</option>
                        <option value="Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¹Ø§Ù…Ø© Ù„Ù„ØªØ·ÙˆÙŠØ± Ø§Ù„Ù…Ø¤Ø³Ø³ÙŠ">Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¹Ø§Ù…Ø© Ù„Ù„ØªØ·ÙˆÙŠØ± Ø§Ù„Ù…Ø¤Ø³Ø³ÙŠ</option>
                    </optgroup>
                    <optgroup label="=== Ø§Ù„ÙƒÙ„ÙŠØ§Øª ÙˆØ§Ù„Ù…Ø¹Ø§Ù‡Ø¯ ===">
                        <option value="ÙƒÙ„ÙŠØ© Ø§Ù„Ø·Ø¨ Ø§Ù„Ø¨Ø´Ø±ÙŠ">ÙƒÙ„ÙŠØ© Ø§Ù„Ø·Ø¨ Ø§Ù„Ø¨Ø´Ø±ÙŠ</option>
                        <option value="ÙƒÙ„ÙŠØ© Ø§Ù„Ù‡Ù†Ø¯Ø³Ø©">ÙƒÙ„ÙŠØ© Ø§Ù„Ù‡Ù†Ø¯Ø³Ø©</option>
                        <option value="ÙƒÙ„ÙŠØ© Ø§Ù„Ø¹Ù„ÙˆÙ…">ÙƒÙ„ÙŠØ© Ø§Ù„Ø¹Ù„ÙˆÙ…</option>
                        <option value="ÙƒÙ„ÙŠØ© Ø§Ù„ØµÙŠØ¯Ù„Ø©">ÙƒÙ„ÙŠØ© Ø§Ù„ØµÙŠØ¯Ù„Ø©</option>
                        <option value="ÙƒÙ„ÙŠØ© Ø§Ù„Ø·Ø¨ Ø§Ù„Ø¨ÙŠØ·Ø±ÙŠ">ÙƒÙ„ÙŠØ© Ø§Ù„Ø·Ø¨ Ø§Ù„Ø¨ÙŠØ·Ø±ÙŠ</option>
                        <option value="ÙƒÙ„ÙŠØ© Ø§Ù„Ø²Ø±Ø§Ø¹Ø©">ÙƒÙ„ÙŠØ© Ø§Ù„Ø²Ø±Ø§Ø¹Ø©</option>
                        <option value="ÙƒÙ„ÙŠØ© Ø§Ù„ØªØ¬Ø§Ø±Ø©">ÙƒÙ„ÙŠØ© Ø§Ù„ØªØ¬Ø§Ø±Ø©</option>
                        <option value="ÙƒÙ„ÙŠØ© Ø§Ù„ØªØ±Ø¨ÙŠØ©">ÙƒÙ„ÙŠØ© Ø§Ù„ØªØ±Ø¨ÙŠØ©</option>
                        <option value="ÙƒÙ„ÙŠØ© Ø§Ù„Ø­Ù‚ÙˆÙ‚">ÙƒÙ„ÙŠØ© Ø§Ù„Ø­Ù‚ÙˆÙ‚</option>
                        <option value="ÙƒÙ„ÙŠØ© Ø§Ù„Ø¢Ø¯Ø§Ø¨">ÙƒÙ„ÙŠØ© Ø§Ù„Ø¢Ø¯Ø§Ø¨</option>
                        <option value="ÙƒÙ„ÙŠØ© Ø§Ù„Ø­Ø§Ø³Ø¨Ø§Øª ÙˆØ§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª">ÙƒÙ„ÙŠØ© Ø§Ù„Ø­Ø§Ø³Ø¨Ø§Øª ÙˆØ§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª</option>
                        <option value="ÙƒÙ„ÙŠØ© Ø§Ù„ØªÙ…Ø±ÙŠØ¶">ÙƒÙ„ÙŠØ© Ø§Ù„ØªÙ…Ø±ÙŠØ¶</option>
                        <option value="ÙƒÙ„ÙŠØ© Ø§Ù„ØªØ±Ø¨ÙŠØ© Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠØ©">ÙƒÙ„ÙŠØ© Ø§Ù„ØªØ±Ø¨ÙŠØ© Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠØ©</option>
                        <option value="ÙƒÙ„ÙŠØ© Ø§Ù„Ø®Ø¯Ù…Ø© Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠØ©">ÙƒÙ„ÙŠØ© Ø§Ù„Ø®Ø¯Ù…Ø© Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠØ©</option>
                        <option value="ÙƒÙ„ÙŠØ© Ø§Ù„ØªØ±Ø¨ÙŠØ© Ø§Ù„Ù†ÙˆØ¹ÙŠØ©">ÙƒÙ„ÙŠØ© Ø§Ù„ØªØ±Ø¨ÙŠØ© Ø§Ù„Ù†ÙˆØ¹ÙŠØ©</option>
                        <option value="ÙƒÙ„ÙŠØ© Ø·Ø¨ Ø§Ù„Ø£Ø³Ù†Ø§Ù†">ÙƒÙ„ÙŠØ© Ø·Ø¨ Ø§Ù„Ø£Ø³Ù†Ø§Ù†</option>
                        <option value="ÙƒÙ„ÙŠØ© Ø§Ù„ÙÙ†ÙˆÙ† Ø§Ù„Ø¬Ù…ÙŠÙ„Ø©">ÙƒÙ„ÙŠØ© Ø§Ù„ÙÙ†ÙˆÙ† Ø§Ù„Ø¬Ù…ÙŠÙ„Ø©</option>
                        <option value="ÙƒÙ„ÙŠØ© Ø§Ù„ØªØ±Ø¨ÙŠØ© Ù„Ù„Ø·ÙÙˆÙ„Ø© Ø§Ù„Ù…Ø¨ÙƒØ±Ø©">ÙƒÙ„ÙŠØ© Ø§Ù„ØªØ±Ø¨ÙŠØ© Ù„Ù„Ø·ÙÙˆÙ„Ø© Ø§Ù„Ù…Ø¨ÙƒØ±Ø©</option>
                        <option value="ÙƒÙ„ÙŠØ© ØªÙƒÙ†ÙˆÙ„ÙˆØ¬ÙŠØ§ ØµÙ†Ø§Ø¹Ø© Ø§Ù„Ø³ÙƒØ± ÙˆØ§Ù„ØµÙ†Ø§Ø¹Ø§Øª Ø§Ù„ØªÙƒØ§Ù…Ù„ÙŠØ©">ÙƒÙ„ÙŠØ© ØªÙƒÙ†ÙˆÙ„ÙˆØ¬ÙŠØ§ ØµÙ†Ø§Ø¹Ø© Ø§Ù„Ø³ÙƒØ± ÙˆØ§Ù„ØµÙ†Ø§Ø¹Ø§Øª Ø§Ù„ØªÙƒØ§Ù…Ù„ÙŠØ©</option>
                        <option value="Ù…Ø¹Ù‡Ø¯ Ø¬Ù†ÙˆØ¨ Ù…ØµØ± Ù„Ù„Ø£ÙˆØ±Ø§Ù…">Ù…Ø¹Ù‡Ø¯ Ø¬Ù†ÙˆØ¨ Ù…ØµØ± Ù„Ù„Ø£ÙˆØ±Ø§Ù…</option>
                        <option value="Ù…Ø¹Ù‡Ø¯ Ø¯Ø±Ø§Ø³Ø§Øª Ø§Ù„Ø¨ÙŠÙˆÙ„ÙˆØ¬ÙŠØ§ Ø§Ù„Ø¬Ø²ÙŠØ¦ÙŠØ©">Ù…Ø¹Ù‡Ø¯ Ø¯Ø±Ø§Ø³Ø§Øª Ø§Ù„Ø¨ÙŠÙˆÙ„ÙˆØ¬ÙŠØ§ Ø§Ù„Ø¬Ø²ÙŠØ¦ÙŠØ©</option>
                    </optgroup>
                </select>
            </div>
            
            <button onclick="login()" class="submit-btn" style="width: 100%;">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</button>
            <p style="margin-top: 15px; font-size: 0.9em; color: #555;">Ù„Ù„ØªØ¬Ø±Ø¨Ø©: Ø§Ø³ØªØ®Ø¯Ù… Ø£ÙŠ Ø§Ø³Ù… Ù…Ø³ØªØ®Ø¯Ù… Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø£Ø¯Ù†Ø§Ù‡ Ù…Ø¹ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± <b>123456</b></p>
            
            <p style="text-align: right; margin-top: 20px; font-size: 0.8em; color: #888; border-top: 1px dashed #eee; padding-top: 10px;">
                <b>Ø­Ø³Ø§Ø¨Ø§Øª Ø§Ù„ØªØ¬Ø±Ø¨Ø©:</b><br>
                - <b>dept_official</b> (Ù…Ø³Ø¤ÙˆÙ„ Ø§Ù„ÙƒÙ„ÙŠØ©/Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©)<br>
                - <b>college_sec</b> (Ø£Ù…ÙŠÙ† Ø§Ù„ÙƒÙ„ÙŠØ© - Ø³ÙŠØ¸Ù‡Ø± Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„ÙƒÙ„ÙŠØ©)<br>
                - <b>quality_admin</b> (Ù…Ø³Ø¤ÙˆÙ„ Ø¶Ø¨Ø· Ø§Ù„ÙˆØ«Ø§Ø¦Ù‚)<br>
                - <b>quality_manager</b> (Ù…Ø¯ÙŠØ± Ø§Ù„Ø¬ÙˆØ¯Ø©)<br>
                - <b>sec_general</b> (Ø£Ù…ÙŠÙ† Ø§Ù„Ø¬Ø§Ù…Ø¹Ø©)<br>
                - <b>print_shop</b> (Ù…Ø³Ø¤ÙˆÙ„ Ø§Ù„Ù…Ø·Ø¨Ø¹Ø©)<br>
                - <b>admin</b> (Ù…Ø­Ù…Ø¯ Ø§Ù„Ø¹Ø¯ÙˆÙ‰ - Ù…Ø¯ÙŠØ± Ø§Ù„Ù†Ø¸Ø§Ù… - ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±: admin)
            </p>

            <div style="margin-top: 20px; padding: 15px; background: #f8f9fa; border-radius: 8px; border: 1px solid #ddd;">
                <h4 style="color: var(--primary-color); margin-bottom: 10px;">ğŸ“ Ø§Ù„Ø¯Ø¹Ù… Ø§Ù„ÙÙ†ÙŠ</h4>
                <p style="margin: 5px 0; font-size: 0.9em;">Ù„Ù„Ø§Ø³ØªÙØ³Ø§Ø±Ø§Øª ÙˆØ§Ù„Ø¯Ø¹Ù… Ø§Ù„ÙÙ†ÙŠ:</p>
                <div class="support-phone">01000778974</div>
                <p style="margin: 5px 0; font-size: 0.8em; color: #666;">Ù…ØªØ§Ø­ Ø®Ù„Ø§Ù„ Ø£ÙˆÙ‚Ø§Øª Ø§Ù„Ø¹Ù…Ù„ Ø§Ù„Ø±Ø³Ù…ÙŠØ©</p>
            </div>
        </div>
        
        <div id="preview-pane">
            <h3>Ø´ÙƒÙ„ ÙˆØ«ÙŠÙ‚Ø© Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¬ÙˆØ¯Ø©</h3>
            <p style="color: #6c757d; margin-bottom: 20px;">Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§ÙØªØ±Ø§Ø¶ÙŠØ© Ù„ØªÙˆØ¬ÙŠÙ‡ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†.</p>
            
            <div style="border: 2px dashed #004a99; padding: 20px; width: 90%; height: 75%; background-color: #fcfcfc; position: relative; box-shadow: 0 0 10px rgba(0, 0, 0, 0.05);">
                <h4 style="color: var(--primary-color); border-bottom: 2px solid var(--secondary-color); padding-bottom: 5px; text-align: center;">Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ø±Ø³Ù…ÙŠ (ISO Compliant)</h4>
                <div style="text-align: right; padding: 10px; border: 1px solid #eee; background-color: #fff; margin-top: 15px; font-size: 0.9em;">
                    <p style="margin-bottom: 5px;"><strong>Ø§Ø³Ù… Ø§Ù„ÙˆØ«ÙŠÙ‚Ø©:</strong> Ù†Ù…ÙˆØ°Ø¬ Ø§Ø¹ØªÙ…Ø§Ø¯ Ø·Ù„Ø¨ Ø·Ø¨Ø§Ø¹Ø© / Ø¥ØµØ¯Ø§Ø± Ø±Ù‚Ù… 02</p>
                    <p style="margin-bottom: 5px;"><strong>Ø¬Ù‡Ø© Ø§Ù„Ø¥ØµØ¯Ø§Ø±:</strong> Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¬ÙˆØ¯Ø© ÙˆØ§Ù„ØªÙ…ÙŠØ² - Ø¬Ø§Ù…Ø¹Ø© Ø£Ø³ÙŠÙˆØ·</p>
                    <p><strong>Ø­Ø§Ù„Ø© Ø§Ù„ÙˆØ«ÙŠÙ‚Ø©:</strong> Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ ÙˆÙ‚ÙŠØ¯ Ø§Ù„ØªØ¯Ø§ÙˆÙ„</p>
                </div>
                <p style="text-align: center; margin-top: 50px; color: #555; font-style: italic;">[Ù…Ø­ØªÙˆÙ‰ Ø§Ù„ÙˆØ«ÙŠÙ‚Ø© Ø§Ù„ØªÙØµÙŠÙ„ÙŠ ÙˆØ§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø¹ØªÙ…Ø¯Ø©]</p>
                <div style="position: absolute; bottom: 20px; left: 20px; right: 20px; border-top: 1px solid #aaa; padding-top: 10px; font-size: 0.8em; text-align: center;">
                    <p>Ø³Ù„Ø³Ù„Ø© Ø§Ù„ØªÙˆÙ‚ÙŠØ¹Ø§Øª Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ© Ø§Ù„Ù…Ø¹ØªÙ…Ø¯Ø©: Ø£Ù…ÙŠÙ† Ø§Ù„ÙƒÙ„ÙŠØ© â¡ï¸ Ù…Ø³Ø¤ÙˆÙ„ Ø¶Ø¨Ø· Ø§Ù„ÙˆØ«Ø§Ø¦Ù‚ â¡ï¸ Ù…Ø¯ÙŠØ± Ø§Ù„Ø¬ÙˆØ¯Ø© â¡ï¸ Ø£Ù…ÙŠÙ† Ø§Ù„Ø¬Ø§Ù…Ø¹Ø©</p>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Ù†Ø§ÙØ°Ø© Ø§Ø³ØªØ¨Ø¯Ø§Ù„ Ø§Ù„Ù…Ø³ØªÙ†Ø¯ -->
    <div id="replace-modal" class="replace-modal">
        <div class="replace-modal-content">
            <h3>Ø§Ø³ØªØ¨Ø¯Ø§Ù„ Ø§Ù„Ù…Ø³ØªÙ†Ø¯</h3>
            <p>ÙŠØ±Ø¬Ù‰ Ø±ÙØ¹ Ø§Ù„Ù…Ø³ØªÙ†Ø¯ Ø§Ù„Ù…Ø¹Ø¯Ù„ Ø·Ø¨Ù‚Ø§Ù‹ Ù„Ù„Ù…ÙˆØ§ØµÙØ© Ø§Ù„Ù‚ÙŠØ§Ø³ÙŠØ©:</p>
            <input type="file" id="new-document-file" accept=".pdf, .docx" style="margin: 15px 0; width: 100%; padding: 10px;">
            <div class="modal-buttons">
                <button onclick="confirmReplace()" class="submit-btn">âœ… ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø§Ø³ØªØ¨Ø¯Ø§Ù„</button>
                <button onclick="cancelReplace()" class="logout-btn">âŒ Ø¥Ù„ØºØ§Ø¡</button>
            </div>
        </div>
    </div>
    
    <!-- Ù†Ø§ÙØ°Ø© Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„Ù…Ø³ØªÙ†Ø¯ -->
    <div id="preview-modal" class="preview-modal">
        <div class="preview-modal-content">
            <div class="preview-header">
                <h3 id="preview-title">Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„Ù…Ø³ØªÙ†Ø¯</h3>
                <button onclick="closePreview()" class="logout-btn" style="margin: 0;">âŒ Ø¥ØºÙ„Ø§Ù‚</button>
            </div>
            <div id="preview-content">
                <!-- Ø³ÙŠØªÙ… ØªØ­Ù…ÙŠÙ„ Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù…Ø³ØªÙ†Ø¯ Ù‡Ù†Ø§ -->
            </div>
            <div class="preview-actions">
                <button onclick="downloadCurrentDocument()" class="download-btn">ğŸ“¥ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø³ØªÙ†Ø¯</button>
                <button onclick="printCurrentDocument()" class="submit-btn">ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø©</button>
            </div>
        </div>
    </div>
    
    <div id="main-content">

        <header class="header">
            <h1>
                <span class="header-logo flag-emblem">ğŸ‡ªğŸ‡¬</span> 
                
                <span class="header-logo vision-emblem">Ø±Ø¤ÙŠØ© 2030</span>

                <span class="icon">ğŸ“âœ…</span>
                Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø¶Ø¨Ø· Ø§Ù„ÙˆØ«Ø§Ø¦Ù‚ Ø§Ù„Ø°ÙƒÙŠ
                <span class="university-logo">| Ø¬Ø§Ù…Ø¹Ø© Ø£Ø³ÙŠÙˆØ·</span>
            </h1>
            
            <div class="header-user-section">
                <div class="user-avatar" id="user-avatar">ğŸ‘¤</div>
                <div class="user-info">
                    <div class="user-name" id="user-display-name">Ù…Ø±Ø­Ø¨Ø§Ù‹ØŒ (ÙŠØ±Ø¬Ù‰ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„)</div>
                    <div class="user-role" id="user-display-role"></div>
                </div>
            </div>
            
            <div class="header-controls">
                <!-- Ø²Ø± ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ ÙÙŠ Ø£Ù‚ØµÙ‰ Ø§Ù„ÙŠØ³Ø§Ø± -->
                <button onclick="logout()" class="logout-btn">ğŸšª ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</button>
                
                <!-- Ø¨Ù‚ÙŠØ© Ø¹Ù†Ø§ØµØ± Ø§Ù„ØªØ­ÙƒÙ… -->
                <a href="tel:01000778974" class="contact-btn">ğŸ“ Ø§Ù„Ø¯Ø¹Ù… Ø§Ù„ÙÙ†ÙŠ</a>
                <span class="visitor-counter">
                    ğŸ‘¤ Ø§Ù„Ø²ÙˆØ§Ø±: <b id="visitor-count">0</b>
                </span>
            </div>
        </header>

        <div class="container">
            <section class="form-section">
                <h2>ØªÙ‚Ø¯ÙŠÙ… Ø·Ù„Ø¨ Ø·Ø¨Ø§Ø¹Ø© Ø¬Ø¯ÙŠØ¯ (Ø§Ù„Ù…ÙŠØ²Ø© ØºÙŠØ± Ù…ØªØ§Ø­Ø© Ù„Ø¯ÙˆØ±ÙƒÙ…)</h2> 
                <p style="margin-bottom: 15px; color: #e74c3c; font-weight: bold;">ÙŠÙØ±Ø¬Ù‰ Ø§Ù„Ø¹Ù„Ù… Ø£Ù† Ù…Ù‡Ù…ØªÙƒÙ… ÙÙŠ Ø§Ù„Ù†Ø¸Ø§Ù… Ù‡ÙŠ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø© ÙˆØ§Ù„ØªÙˆÙ‚ÙŠØ¹/Ø§Ù„Ø·Ø¨Ø§Ø¹Ø© ÙÙ‚Ø·. ØªÙ‚Ø¯ÙŠÙ… Ø§Ù„Ø·Ù„Ø¨Ø§Øª ÙŠØªÙ… Ù…Ù† Ø£Ø¯ÙˆØ§Ø± Ø£Ø®Ø±Ù‰.</p>
                
                <form id="print-request-form">
                    <div class="form-group">
                        <label for="requester-name">Ø§Ø³Ù… Ø§Ù„Ù…ÙˆØ¸Ù Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ (Ø§Ù„Ù…Ø±Ø³Ù„):</label>
                        <input type="text" id="requester-name" name="requester-name" required value="Ø£Ø­Ù…Ø¯ Ù…Ø­Ù…Ø¯">
                    </div>
                    <div class="form-group">
                        <label for="college-name">Ø§Ù„ÙƒÙ„ÙŠØ© / Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø·Ø§Ù„Ø¨Ø©:</label>
                        <select id="college-name" name="college-name" required>
                            <option value="">Ø§Ø®ØªØ± Ø§Ù„ÙƒÙ„ÙŠØ©/Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</option>
                            <optgroup label="=== Ø§Ù„ÙˆØ­Ø¯Ø§Øª Ø§Ù„Ø¥Ø¯Ø§Ø±ÙŠØ© ===">
                                <option value="Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¬ÙˆØ¯Ø© ÙˆØ§Ù„ØªÙ…ÙŠØ²" selected>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¬ÙˆØ¯Ø© ÙˆØ§Ù„ØªÙ…ÙŠØ²</option>
                                <option value="Ø§Ù„Ø´Ø¤ÙˆÙ† Ø§Ù„Ø¥Ø¯Ø§Ø±ÙŠØ©">Ø§Ù„Ø´Ø¤ÙˆÙ† Ø§Ù„Ø¥Ø¯Ø§Ø±ÙŠØ©</option>
                                <option value="Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¹Ø§Ù…Ø© Ù„Ø´Ø¤ÙˆÙ† Ø§Ù„Ø·Ù„Ø§Ø¨">Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¹Ø§Ù…Ø© Ù„Ø´Ø¤ÙˆÙ† Ø§Ù„Ø·Ù„Ø§Ø¨</option>
                                <option value="Ø§Ù„Ù…ÙƒØªØ¨ Ø§Ù„ÙÙ†ÙŠ Ù„Ø±Ø¦ÙŠØ³ Ø§Ù„Ø¬Ø§Ù…Ø¹Ø©">Ø§Ù„Ù…ÙƒØªØ¨ Ø§Ù„ÙÙ†ÙŠ Ù„Ø±Ø¦ÙŠØ³ Ø§Ù„Ø¬Ø§Ù…Ø¹Ø©</option>
                                <option value="Ù‚Ø³Ù… Ø§Ù„Ø¬ÙˆØ¯Ø©">Ù‚Ø³Ù… Ø§Ù„Ø¬ÙˆØ¯Ø©</option>
                                <option value="Ù‚Ø³Ù… ØªÙƒØ§ÙØ¤ Ø§Ù„ÙØ±Øµ">Ù‚Ø³Ù… ØªÙƒØ§ÙØ¤ Ø§Ù„ÙØ±Øµ</option>
                                <option value="Ù‚Ø³Ù… Ø§Ù„ØªÙ…ÙŠØ²">Ù‚Ø³Ù… Ø§Ù„ØªÙ…ÙŠØ²</option>
                                <option value="Ù‚Ø³Ù… Ø§Ù„Ø¯Ø¹Ù… Ø§Ù„Ù„ÙˆØ¬Ø³ØªÙŠ">Ù‚Ø³Ù… Ø§Ù„Ø¯Ø¹Ù… Ø§Ù„Ù„ÙˆØ¬Ø³ØªÙŠ</option>
                                <option value="Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¹Ø§Ù…Ø© Ù„Ù†Ø¸Ù… Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª ÙˆØ§Ù„ØªØ­ÙˆÙ„ Ø§Ù„Ø±Ù‚Ù…ÙŠ">Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¹Ø§Ù…Ø© Ù„Ù†Ø¸Ù… Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª ÙˆØ§Ù„ØªØ­ÙˆÙ„ Ø§Ù„Ø±Ù‚Ù…ÙŠ</option>
                                <option value="Ù…Ø±ÙƒØ² ØªØ·ÙˆÙŠØ± Ù†Ø¸Ù… Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¥Ø¯Ø§Ø±ÙŠØ©">Ù…Ø±ÙƒØ² ØªØ·ÙˆÙŠØ± Ù†Ø¸Ù… Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¥Ø¯Ø§Ø±ÙŠØ©</option>
                                <option value="Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¹Ø§Ù…Ø© Ù„Ù„ØªØ·ÙˆÙŠØ± Ø§Ù„Ù…Ø¤Ø³Ø³ÙŠ">Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¹Ø§Ù…Ø© Ù„Ù„ØªØ·ÙˆÙŠØ± Ø§Ù„Ù…Ø¤Ø³Ø³ÙŠ</option>
                            </optgroup>
                            <optgroup label="=== Ø§Ù„ÙƒÙ„ÙŠØ§Øª ÙˆØ§Ù„Ù…Ø¹Ø§Ù‡Ø¯ ===">
                                <option value="ÙƒÙ„ÙŠØ© Ø§Ù„Ø·Ø¨ Ø§Ù„Ø¨Ø´Ø±ÙŠ">ÙƒÙ„ÙŠØ© Ø§Ù„Ø·Ø¨ Ø§Ù„Ø¨Ø´Ø±ÙŠ</option>
                                <option value="ÙƒÙ„ÙŠØ© Ø§Ù„Ù‡Ù†Ø¯Ø³Ø©">ÙƒÙ„ÙŠØ© Ø§Ù„Ù‡Ù†Ø¯Ø³Ø©</option>
                                <option value="ÙƒÙ„ÙŠØ© Ø§Ù„Ø¹Ù„ÙˆÙ…">ÙƒÙ„ÙŠØ© Ø§Ù„Ø¹Ù„ÙˆÙ…</option>
                                <option value="ÙƒÙ„ÙŠØ© Ø§Ù„ØµÙŠØ¯Ù„Ø©">ÙƒÙ„ÙŠØ© Ø§Ù„ØµÙŠØ¯Ù„Ø©</option>
                                <option value="ÙƒÙ„ÙŠØ© Ø§Ù„Ø·Ø¨ Ø§Ù„Ø¨ÙŠØ·Ø±ÙŠ">ÙƒÙ„ÙŠØ© Ø§Ù„Ø·Ø¨ Ø§Ù„Ø¨ÙŠØ·Ø±ÙŠ</option>
                                <option value="ÙƒÙ„ÙŠØ© Ø§Ù„Ø²Ø±Ø§Ø¹Ø©">ÙƒÙ„ÙŠØ© Ø§Ù„Ø²Ø±Ø§Ø¹Ø©</option>
                                <option value="ÙƒÙ„ÙŠØ© Ø§Ù„ØªØ¬Ø§Ø±Ø©">ÙƒÙ„ÙŠØ© Ø§Ù„ØªØ¬Ø§Ø±Ø©</option>
                                <option value="ÙƒÙ„ÙŠØ© Ø§Ù„ØªØ±Ø¨ÙŠØ©">ÙƒÙ„ÙŠØ© Ø§Ù„ØªØ±Ø¨ÙŠØ©</option>
                                <option value="ÙƒÙ„ÙŠØ© Ø§Ù„Ø­Ù‚ÙˆÙ‚">ÙƒÙ„ÙŠØ© Ø§Ù„Ø­Ù‚ÙˆÙ‚</option>
                                <option value="ÙƒÙ„ÙŠØ© Ø§Ù„Ø¢Ø¯Ø§Ø¨">ÙƒÙ„ÙŠØ© Ø§Ù„Ø¢Ø¯Ø§Ø¨</option>
                                <option value="ÙƒÙ„ÙŠØ© Ø§Ù„Ø­Ø§Ø³Ø¨Ø§Øª ÙˆØ§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª">ÙƒÙ„ÙŠØ© Ø§Ù„Ø­Ø§Ø³Ø¨Ø§Øª ÙˆØ§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª</option>
                                <option value="ÙƒÙ„ÙŠØ© Ø§Ù„ØªÙ…Ø±ÙŠØ¶">ÙƒÙ„ÙŠØ© Ø§Ù„ØªÙ…Ø±ÙŠØ¶</option>
                                <option value="ÙƒÙ„ÙŠØ© Ø§Ù„ØªØ±Ø¨ÙŠØ© Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠØ©">ÙƒÙ„ÙŠØ© Ø§Ù„ØªØ±Ø¨ÙŠØ© Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠØ©</option>
                                <option value="ÙƒÙ„ÙŠØ© Ø§Ù„Ø®Ø¯Ù…Ø© Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠØ©">ÙƒÙ„ÙŠØ© Ø§Ù„Ø®Ø¯Ù…Ø© Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠØ©</option>
                                <option value="ÙƒÙ„ÙŠØ© Ø§Ù„ØªØ±Ø¨ÙŠØ© Ø§Ù„Ù†ÙˆØ¹ÙŠØ©">ÙƒÙ„ÙŠØ© Ø§Ù„ØªØ±Ø¨ÙŠØ© Ø§Ù„Ù†ÙˆØ¹ÙŠØ©</option>
                                <option value="ÙƒÙ„ÙŠØ© Ø·Ø¨ Ø§Ù„Ø£Ø³Ù†Ø§Ù†">ÙƒÙ„ÙŠØ© Ø·Ø¨ Ø§Ù„Ø£Ø³Ù†Ø§Ù†</option>
                                <option value="ÙƒÙ„ÙŠØ© Ø§Ù„ÙÙ†ÙˆÙ† Ø§Ù„Ø¬Ù…ÙŠÙ„Ø©">ÙƒÙ„ÙŠØ© Ø§Ù„ÙÙ†ÙˆÙ† Ø§Ù„Ø¬Ù…ÙŠÙ„Ø©</option>
                                <option value="ÙƒÙ„ÙŠØ© Ø§Ù„ØªØ±Ø¨ÙŠØ© Ù„Ù„Ø·ÙÙˆÙ„Ø© Ø§Ù„Ù…Ø¨ÙƒØ±Ø©">ÙƒÙ„ÙŠØ© Ø§Ù„ØªØ±Ø¨ÙŠØ© Ù„Ù„Ø·ÙÙˆÙ„Ø© Ø§Ù„Ù…Ø¨ÙƒØ±Ø©</option>
                                <option value="ÙƒÙ„ÙŠØ© ØªÙƒÙ†ÙˆÙ„ÙˆØ¬ÙŠØ§ ØµÙ†Ø§Ø¹Ø© Ø§Ù„Ø³ÙƒØ± ÙˆØ§Ù„ØµÙ†Ø§Ø¹Ø§Øª Ø§Ù„ØªÙƒØ§Ù…Ù„ÙŠØ©">ÙƒÙ„ÙŠØ© ØªÙƒÙ†ÙˆÙ„ÙˆØ¬ÙŠØ§ ØµÙ†Ø§Ø¹Ø© Ø§Ù„Ø³ÙƒØ± ÙˆØ§Ù„ØµÙ†Ø§Ø¹Ø§Øª Ø§Ù„ØªÙƒØ§Ù…Ù„ÙŠØ©</option>
                                <option value="Ù…Ø¹Ù‡Ø¯ Ø¬Ù†ÙˆØ¨ Ù…ØµØ± Ù„Ù„Ø£ÙˆØ±Ø§Ù…">Ù…Ø¹Ù‡Ø¯ Ø¬Ù†ÙˆØ¨ Ù…ØµØ± Ù„Ù„Ø£ÙˆØ±Ø§Ù…</option>
                                <option value="Ù…Ø¹Ù‡Ø¯ Ø¯Ø±Ø§Ø³Ø§Øª Ø§Ù„Ø¨ÙŠÙˆÙ„ÙˆØ¬ÙŠØ§ Ø§Ù„Ø¬Ø²ÙŠØ¦ÙŠØ©">Ù…Ø¹Ù‡Ø¯ Ø¯Ø±Ø§Ø³Ø§Øª Ø§Ù„Ø¨ÙŠÙˆÙ„ÙˆØ¬ÙŠØ§ Ø§Ù„Ø¬Ø²ÙŠØ¦ÙŠØ©</option>
                            </optgroup>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="whatsapp-number">Ø±Ù‚Ù… Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨ Ù„Ù„ØªÙˆØ§ØµÙ„:</label>
                        <input type="text" id="whatsapp-number" name="whatsapp-number" required value="01xxxxxxxxx">
                    </div>
                    <div class="form-group">
                        <label for="document-file">Ø¥Ø±ÙØ§Ù‚ Ø§Ù„Ù…Ø³ØªÙ†Ø¯Ø§Øª Ù„Ù„Ø·Ø¨Ø§Ø¹Ø© (Ù…Ù„Ù):</label>
                        <input type="file" id="document-file" name="document-file" accept=".pdf, .docx" required onchange="handleFileUpload(event)">
                        <small>ÙŠØ±Ø¬Ù‰ Ø¥Ø±ÙØ§Ù‚ Ù…Ù„ÙØ§Øª PDF Ø£Ùˆ Word ÙÙ‚Ø·. (Ø³ÙŠØªÙ… Ø­ÙØ¸ Ø§Ù„Ù…Ù„Ù ÙØ¹Ù„ÙŠØ§Ù‹ ÙÙŠ Ø§Ù„Ù†Ø¸Ø§Ù…)</small>
                    </div>
                    <button type="submit" class="submit-btn">Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨ Ø§Ù„Ø·Ø¨Ø§Ø¹Ø©</button>
                </form>
            </section>

            <hr style="margin: 40px 0; border-color: #eee;">

            <!-- Ù‚Ø³Ù… Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø¬Ø¯ÙŠØ¯ -->
            <section class="reports-section">
                <h2>ğŸ“Š Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª ÙˆØ§Ù„ØªÙ‚Ø§Ø±ÙŠØ±</h2>
                <div class="stats-grid">
                    <div class="stat-card">
                        <div style="font-size: 2em; color: var(--primary-color);">ğŸ“ˆ</div>
                        <h3 style="color: var(--primary-color);">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø·Ù„Ø¨Ø§Øª</h3>
                        <p id="total-requests" style="font-size: 1.5em; font-weight: bold;">0</p>
                    </div>
                    <div class="stat-card">
                        <div style="font-size: 2em; color: #f39c12;">â³</div>
                        <h3 style="color: #f39c12;">Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©</h3>
                        <p id="pending-requests" style="font-size: 1.5em; font-weight: bold;">0</p>
                    </div>
                    <div class="stat-card">
                        <div style="font-size: 2em; color: #27ae60;">âœ…</div>
                        <h3 style="color: #27ae60;">Ù…ÙƒØªÙ…Ù„</h3>
                        <p id="completed-requests" style="font-size: 1.5em; font-weight: bold;">0</p>
                    </div>
                    <div class="stat-card">
                        <div style="font-size: 2em; color: #3498db;">ğŸ”„</div>
                        <h3 style="color: #3498db;">ÙÙŠ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©</h3>
                        <p id="review-requests" style="font-size: 1.5em; font-weight: bold;">0</p>
                    </div>
                </div>
                
                <!-- Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ù†Ø³Ø® Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠ -->
                <div style="margin-top: 20px; display: flex; gap: 10px; flex-wrap: wrap;">
                    <button onclick="exportData()" class="backup-btn">ğŸ’¾ ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</button>
                    <button onclick="document.getElementById('import-file').click()" class="backup-btn">ğŸ“ Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</button>
                    <input type="file" id="import-file" accept=".json" style="display: none;" onchange="importData(event)">
                </div>
            </section>

            <hr style="margin: 40px 0; border-color: #eee;">

            <section class="status-section">
                <h2>ØªØªØ¨Ø¹ Ø­Ø§Ù„Ø© Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø·Ø¨Ø§Ø¹Ø© (Ø¢Ø®Ø± ØªØ²Ø§Ù…Ù†: <span id="last-sync-time">---</span>)</h2>
                
                <!-- ØªØ­Ø°ÙŠØ± Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ© Ù„Ø£Ù…Ù†Ø§Ø¡ Ø§Ù„ÙƒÙ„ÙŠØ§Øª -->
                <div id="college-sec-warning" class="permission-warning" style="display: none;">
                    <strong>Ù…Ù„Ø§Ø­Ø¸Ø© Ù‡Ø§Ù…Ø©:</strong> ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„ØªÙˆÙ‚ÙŠØ¹ ÙÙ‚Ø· Ø¹Ù„Ù‰ Ø·Ù„Ø¨Ø§Øª ÙƒÙ„ÙŠØªÙƒ (<span id="user-college-name"></span>) ÙˆÙ„Ø§ ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„ØªÙˆÙ‚ÙŠØ¹ Ø¹Ù„Ù‰ Ø·Ù„Ø¨Ø§Øª Ø§Ù„ÙƒÙ„ÙŠØ§Øª Ø§Ù„Ø£Ø®Ø±Ù‰.
                </div>
                
                <p style="margin-bottom: 15px;">**Ù„Ù„ØªØ¬Ø±Ø¨Ø©:** Ø²Ø± **"Ø§Ù„ØªÙˆÙ‚ÙŠØ¹ / Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø©"** ÙŠØ¸Ù‡Ø± ÙÙ‚Ø· Ù„Ø¯ÙˆØ± Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø°ÙŠ Ù‚Ø§Ù… Ø¨ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„.</p>
                
                <!-- Ù‚Ø³Ù… Ø§Ù„ØªØµÙÙŠØ© ÙˆØ§Ù„Ø¨Ø­Ø« Ø§Ù„Ø¬Ø¯ÙŠØ¯ -->
                <div class="filters-section">
                    <div class="filters-container">
                        <input type="text" id="search-requests" class="search-input" placeholder="ğŸ” Ø¨Ø­Ø« Ø¨Ø±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨ Ø£Ùˆ Ø§Ø³Ù… Ø§Ù„ÙƒÙ„ÙŠØ©...">
                        <select id="status-filter" class="filter-select">
                            <option value="">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ø§Ù„Ø§Øª</option>
                            <option value="Pending">Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©</option>
                            <option value="DCO_Review">Ù„Ø¯Ù‰ Ø¶Ø¨Ø· Ø§Ù„ÙˆØ«Ø§Ø¦Ù‚</option>
                            <option value="Quality_Manager">Ù„Ø¯Ù‰ Ù…Ø¯ÙŠØ± Ø§Ù„Ø¬ÙˆØ¯Ø©</option>
                            <option value="Secretary_General">Ù„Ø¯Ù‰ Ø£Ù…ÙŠÙ† Ø§Ù„Ø¬Ø§Ù…Ø¹Ø©</option>
                            <option value="Approved_To_Print">Ø¬Ø§Ù‡Ø² Ù„Ù„Ø·Ø¨Ø§Ø¹Ø©</option>
                            <option value="Printed">Ù…ÙƒØªÙ…Ù„</option>
                        </select>
                        <button onclick="resetFilters()" class="reset-btn">ğŸ”„ Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ†</button>
                    </div>
                </div>
                
                <table class="status-table">
                    <thead>
                        <tr>
                            <th>Ø±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨</th>
                            <th>Ø§Ù„ÙƒÙ„ÙŠØ© / Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</th>
                            <th>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø·Ù„Ø¨</th>
                            <th>Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©</th>
                            <th>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡ (Ø§Ù„Ù…Ø·Ù„ÙˆØ¨)</th>
                        </tr>
                    </thead>
                    <tbody id="requests-list">
                        </tbody>
                </table>
            </section>
        </div>
    </div>
    <footer class="footer">
        <div class="footer-info">
            <p>Â© <b>Ø­Ù‚ÙˆÙ‚ Ø§Ù„Ù…Ù„ÙƒÙŠØ© Ø§Ù„ÙÙƒØ±ÙŠØ© Ù…Ø­ÙÙˆØ¸Ø©</b>. Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¬ÙˆØ¯Ø© ÙˆØ§Ù„ØªÙ…ÙŠØ²: <b>Ø¬Ø§Ù…Ø¹Ø© Ø£Ø³ÙŠÙˆØ·</b></p>
            <p>Ù†Ø¸Ø§Ù… Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø·Ø¨ÙˆØ¹Ø§Øª - ÙˆÙÙ‚ Ù…ØªØ·Ù„Ø¨Ø§Øª ISO 9001:2015</p>
            <p class="support-note">
                **Ù„Ù„Ø¯Ø¹Ù… Ø§Ù„ÙÙ†ÙŠ ÙˆØ§Ù„Ø§Ø³ØªÙØ³Ø§Ø±Ø§Øª: <span class="support-phone">01000778974</span>**
            </p>
        </div>
        <button id="sync-button" class="sync-btn" onclick="synchronizeData()">
            ğŸ”„ ØªØ²Ø§Ù…Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙŠØ¯ÙˆÙŠÙ‹Ø§
        </button>
    </footer>

    <script>
        // **Ø§Ù„Ø¬Ø²Ø¡ Ø§Ù„Ø£ÙˆÙ„: ØªØ¹Ø±ÙŠÙ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† ÙˆØ§Ù„Ø¯ÙˆØ± Ø§Ù„Ø­Ø§Ù„ÙŠ**
        const mockUsers = [
            { username: 'dept_official', password: '123456', role: 'Dept_Official', name: 'Ù…Ø³Ø¤ÙˆÙ„ Ø§Ù„ÙƒÙ„ÙŠØ©/Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©', requiresCollege: true, avatar: 'ğŸ‘¨â€ğŸ’¼' },
            { username: 'quality_admin', password: '123456', role: 'DCO', name: 'Ù…Ø³Ø¤ÙˆÙ„ Ø¶Ø¨Ø· Ø§Ù„ÙˆØ«Ø§Ø¦Ù‚', requiresCollege: false, avatar: 'ğŸ‘¨â€ğŸ”§' },
            { username: 'college_sec', password: '123456', role: 'College_Secretary', name: 'Ø£Ù…ÙŠÙ† Ø§Ù„ÙƒÙ„ÙŠØ©', requiresCollege: true, avatar: 'ğŸ‘©â€ğŸ’»' },
            { username: 'quality_manager', password: '123456', role: 'Quality_Manager', name: 'Ù…Ø¯ÙŠØ± Ø§Ù„Ø¬ÙˆØ¯Ø©', requiresCollege: false, avatar: 'ğŸ‘¨â€ğŸ’¼' },
            { username: 'sec_general', password: '123456', role: 'Secretary_General', name: 'Ø£Ù…ÙŠÙ† Ø§Ù„Ø¬Ø§Ù…Ø¹Ø©', requiresCollege: false, avatar: 'ğŸ‘¨â€ğŸ“' },
            { username: 'print_shop', password: '123456', role: 'Print_Shop', name: 'Ù…Ø³Ø¤ÙˆÙ„ Ø§Ù„Ù…Ø·Ø¨Ø¹Ø©', requiresCollege: false, avatar: 'ğŸ‘¨â€ğŸ­' },
            { username: 'admin', password: 'admin', role: 'Super_Admin', name: 'Ù…Ø­Ù…Ø¯ Ø§Ù„Ø¹Ø¯ÙˆÙ‰ (Ù…Ø¯ÙŠØ± Ø§Ù„Ù†Ø¸Ø§Ù…)', requiresCollege: false, avatar: 'ğŸ‘‘' }
        ];

        let currentUserRole = null; 
        let currentUserName = null;
        let currentUserCollege = null;
        let currentRequestId = null; // Ù„ØªØ®Ø²ÙŠÙ† Ø±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨ Ø§Ù„Ø­Ø§Ù„ÙŠ Ù„Ù„Ø§Ø³ØªØ¨Ø¯Ø§Ù„
        let currentPreviewDocument = null; // Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø³ØªÙ†Ø¯ Ø§Ù„Ø­Ø§Ù„ÙŠ Ù„Ù„Ù…Ø¹Ø§ÙŠÙ†Ø©

        // **Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ù†ÙˆØ¹ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙˆØ¥Ø¸Ù‡Ø§Ø±/Ø¥Ø®ÙØ§Ø¡ Ø­Ù‚Ù„ Ø§Ù„ÙƒÙ„ÙŠØ©**
        document.getElementById('login-username').addEventListener('input', function() {
            const username = this.value.trim();
            const collegeSelection = document.getElementById('college-selection');
            const userCollegeSelect = document.getElementById('user-college');
            
            const user = mockUsers.find(u => u.username.toLowerCase() === username.toLowerCase());
            
            if (user && user.requiresCollege) {
                collegeSelection.style.display = 'block';
                userCollegeSelect.required = true;
            } else {
                collegeSelection.style.display = 'none';
                userCollegeSelect.required = false;
                userCollegeSelect.value = '';
            }
        });

        // **Ù†Ø¸Ø§Ù… Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø§Ù„Ù…Ø­Ø³Ù†**
        function showNotification(message, type = 'success', duration = 5000) {
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.textContent = message;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, duration);
        }

        // **Ø¯Ø§Ù„Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„**
        function login() {
            const usernameInput = document.getElementById('login-username').value.trim();
            const passwordInput = document.getElementById('login-password').value.trim();
            const userCollegeInput = document.getElementById('user-college').value;
            
            if (usernameInput === '' || passwordInput === '') {
                showNotification('ğŸš« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„: ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙˆÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±.', 'error');
                return;
            }

            const user = mockUsers.find(u => 
                u.username.toLowerCase() === usernameInput.toLowerCase() && 
                u.password === passwordInput
            );

            if (user) {
                // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„ÙƒÙ„ÙŠØ© Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ù…Ø·Ù„ÙˆØ¨ Ù…Ù†Ù‡Ù… Ø°Ù„Ùƒ
                if (user.requiresCollege && userCollegeInput === '') {
                    showNotification('ğŸš« ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„ÙƒÙ„ÙŠØ©/Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªØ§Ø¨Ø¹ Ù„Ù‡Ø§.', 'error');
                    return;
                }

                currentUserRole = user.role;
                currentUserName = user.name;
                currentUserCollege = user.requiresCollege ? userCollegeInput : '';
                
                document.getElementById('login-screen').style.display = 'none';
                document.getElementById('main-content').style.display = 'block';
                
                // ØªØ­Ø¯ÙŠØ« Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙÙŠ Ø§Ù„Ø±Ø£Ø³
                updateUserDisplay(user);
                
                const formElement = document.getElementById('print-request-form');
                const formTitle = document.querySelector('.form-section h2');
                const formNotice = document.querySelector('.form-section p');
                
                if (user.role === 'Dept_Official') {
                    if (formTitle) formTitle.textContent = 'ØªÙ‚Ø¯ÙŠÙ… Ø·Ù„Ø¨ Ø·Ø¨Ø§Ø¹Ø© Ø¬Ø¯ÙŠØ¯';
                    if (formNotice) formNotice.style.display = 'none';
                    if (formElement) formElement.style.display = 'block';
                } else {
                    if (formTitle) formTitle.textContent = 'ØªÙ‚Ø¯ÙŠÙ… Ø·Ù„Ø¨ Ø·Ø¨Ø§Ø¹Ø© Ø¬Ø¯ÙŠØ¯ (Ø§Ù„Ù…ÙŠØ²Ø© ØºÙŠØ± Ù…ØªØ§Ø­Ø© Ù„Ø¯ÙˆØ±ÙƒÙ…)';
                    if (formNotice) formNotice.style.display = 'block';
                    if (formElement) formElement.style.display = 'none';
                }

                // Ø¥Ø¸Ù‡Ø§Ø± ØªØ­Ø°ÙŠØ± Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ© Ù„Ø£Ù…Ù†Ø§Ø¡ Ø§Ù„ÙƒÙ„ÙŠØ§Øª
                if (user.role === 'College_Secretary') {
                    document.getElementById('college-sec-warning').style.display = 'block';
                    document.getElementById('user-college-name').textContent = currentUserCollege;
                } else {
                    document.getElementById('college-sec-warning').style.display = 'none';
                }

                setUserSession(user);
                renderRequests();
                updateStatistics();
                setupFilters();
                showNotification(`âœ… ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ù†Ø¬Ø§Ø­ ÙƒÙ€: ${user.name}${user.requiresCollege ? ' - ' + currentUserCollege : ''}`);
            } else {
                showNotification('âŒ Ø®Ø·Ø£ ÙÙŠ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„: Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø£Ùˆ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± ØµØ­ÙŠØ­ÙŠÙ†. ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙˆØ§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø¬Ø¯Ø¯Ø§Ù‹.', 'error');
            }
        }

        // **Ø¯Ø§Ù„Ø© ØªØ­Ø¯ÙŠØ« Ø¹Ø±Ø¶ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…**
        function updateUserDisplay(user) {
            const userAvatar = document.getElementById('user-avatar');
            const userName = document.getElementById('user-display-name');
            const userRole = document.getElementById('user-display-role');
            
            userAvatar.textContent = user.avatar || 'ğŸ‘¤';
            userName.textContent = user.name;
            userRole.textContent = `${user.role}${currentUserCollege ? ' - ' + currentUserCollege : ''}`;
        }

        // **Ù†Ø¸Ø§Ù… Ø§Ù„Ø¬Ù„Ø³Ø§Øª ÙˆØ§Ù„Ø£Ù…Ø§Ù†**
        function setUserSession(user) {
            const sessionData = {
                user: user,
                userCollege: currentUserCollege,
                loginTime: new Date().toISOString(),
                expires: Date.now() + (8 * 60 * 60 * 1000) // 8 Ø³Ø§Ø¹Ø§Øª
            };
            localStorage.setItem('currentSession', JSON.stringify(sessionData));
        }

        function checkSession() {
            const sessionData = localStorage.getItem('currentSession');
            if (!sessionData) return false;
            
            const session = JSON.parse(sessionData);
            if (Date.now() > session.expires) {
                localStorage.removeItem('currentSession');
                return false;
            }
            
            currentUserCollege = session.userCollege;
            return session.user;
        }

        function autoLogout() {
            setInterval(() => {
                const user = checkSession();
                if (!user) {
                    showNotification('Ø§Ù†ØªÙ‡Øª Ø§Ù„Ø¬Ù„Ø³Ø©ØŒ ÙŠØ±Ø¬Ù‰ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰', 'warning');
                    logout();
                }
            }, 60000); // Ø§Ù„ØªØ­Ù‚Ù‚ ÙƒÙ„ Ø¯Ù‚ÙŠÙ‚Ø©
        }

        function logout() {
            localStorage.removeItem('currentSession');
            currentUserRole = null;
            currentUserName = null;
            currentUserCollege = null;
            
            document.getElementById('login-screen').style.display = 'flex';
            document.getElementById('main-content').style.display = 'none';
            
            // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø­Ù‚ÙˆÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
            document.getElementById('login-username').value = '';
            document.getElementById('login-password').value = '';
            document.getElementById('user-college').value = '';
            document.getElementById('college-selection').style.display = 'none';
            
            showNotification('ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ Ø¨Ù†Ø¬Ø§Ø­', 'success');
        }

        // Ø¯Ø§Ù„Ø© Ù„ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ø§Ù„Ø°Ø§ÙƒØ±Ø© Ø§Ù„Ù…Ø­Ù„ÙŠØ© (localStorage) - ØªØ³ØªØ®Ø¯Ù… Ø§Ù„Ù…ÙØªØ§Ø­ printRequests2
        function loadRequests() {
            const storedRequests = localStorage.getItem('printRequests2');
            return storedRequests ? JSON.parse(storedRequests) : [];
        }

        // Ø¯Ø§Ù„Ø© Ù„Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙÙŠ Ø§Ù„Ø°Ø§ÙƒØ±Ø© Ø§Ù„Ù…Ø­Ù„ÙŠØ© - ØªØ³ØªØ®Ø¯Ù… Ø§Ù„Ù…ÙØªØ§Ø­ printRequests2
        function saveRequests(requests) {
            localStorage.setItem('printRequests2', JSON.stringify(requests));
        }

        // **Ø¯Ø§Ù„Ø© Ù„Ø¥Ù†Ø´Ø§Ø¡ Ø¨ÙŠØ§Ù†Ø§Øª Ø£ÙˆÙ„ÙŠØ© ÙÙŠ Ø­Ø§Ù„ Ù„Ù… ÙŠØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø£ÙŠ Ø·Ù„Ø¨**
        function initializeRequests() {
            let requests = loadRequests();
            if (requests.length === 0) {
                const newDate = new Date().toLocaleDateString('ar-EG', { day: 'numeric', month: 'short', year: 'numeric' });

                const initialRequests = [
                    {
                        id: 1001,
                        requester: 'Ø£Ø­Ù…Ø¯ Ù…Ø­Ù…Ø¯',
                        college: 'ÙƒÙ„ÙŠØ© Ø§Ù„Ù‡Ù†Ø¯Ø³Ø©',
                        whatsapp: '01xxxxxxxxx',
                        date: newDate,
                        status: 'Pending', // ÙŠØ¨Ø¯Ø£ ÙÙŠ Ø§Ù†ØªØ¸Ø§Ø± ØªÙˆÙ‚ÙŠØ¹ College_Secretary
                        documentPath: `docs/print_request_1001_${Date.now()}.pdf`,
                        documentFile: null,
                        documentHistory: []
                    },
                    {
                        id: 1002,
                        requester: 'ÙØ§Ø·Ù…Ø© Ø¹Ù„ÙŠ',
                        college: 'ÙƒÙ„ÙŠØ© Ø§Ù„Ø·Ø¨ Ø§Ù„Ø¨Ø´Ø±ÙŠ',
                        whatsapp: '01xxxxxxxxx',
                        date: newDate,
                        status: 'DCO_Review', // Ù„Ø¯Ù‰ Ù…Ø³Ø¤ÙˆÙ„ Ø¶Ø¨Ø· Ø§Ù„ÙˆØ«Ø§Ø¦Ù‚
                        documentPath: `docs/print_request_1002_${Date.now()}.pdf`,
                        documentFile: null,
                        documentHistory: []
                    },
                    {
                        id: 1003,
                        requester: 'Ù…Ø­Ù…Ø¯ Ø¥Ø¨Ø±Ø§Ù‡ÙŠÙ…',
                        college: 'ÙƒÙ„ÙŠØ© Ø§Ù„Ø¹Ù„ÙˆÙ…',
                        whatsapp: '01xxxxxxxxx',
                        date: newDate,
                        status: 'Approved_To_Print', // ÙŠÙ†ØªØ¸Ø± ØªÙˆÙ‚ÙŠØ¹ Print_Shop
                        documentPath: `docs/print_request_1003_${Date.now()}.pdf`,
                        documentFile: null,
                        documentHistory: []
                    },
                ];
                saveRequests(initialRequests);
            }
        }

        // **Ø¯Ø§Ù„Ø© Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø²ÙˆØ§Ø±**
        function initializeVisitorCounter() {
            let count = localStorage.getItem('visitorCount');
            if (count === null) {
                count = 1;
            } else {
                count = parseInt(count) + 1;
            }
            
            localStorage.setItem('visitorCount', count);
            
            const countElement = document.getElementById('visitor-count');
            if (countElement) {
                countElement.textContent = count;
            }
        }

        // **Ø¯Ø§Ù„Ø© ØªØ­Ø¯ÙŠØ¯ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø­Ø§Ù„Ø©**
        function getStatusDetails(status) {
            let details = {};
            switch(status) {
                case 'Pending':
                    details = { class: 'status-pending', text: 'Ù‚ÙŠØ¯ Ù…Ø±Ø§Ø¬Ø¹Ø© Ø£Ù…ÙŠÙ† Ø§Ù„ÙƒÙ„ÙŠØ©', nextRole: 'College_Secretary', nextStatus: 'DCO_Review' };
                    break;
                case 'DCO_Review':
                    details = { class: 'status-pending', text: 'Ù„Ø¯Ù‰ Ù…Ø³Ø¤ÙˆÙ„ Ø¶Ø¨Ø· Ø§Ù„ÙˆØ«Ø§Ø¦Ù‚ (Ù„Ù„ØªØ¹Ø¯ÙŠÙ„ ÙˆØ§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©)', nextRole: 'DCO', nextStatus: 'Quality_Manager' };
                    break;
                case 'Quality_Manager':
                    details = { class: 'status-approved', text: 'ÙÙŠ Ø§Ù†ØªØ¸Ø§Ø± ØªÙˆÙ‚ÙŠØ¹ Ù…Ø¯ÙŠØ± Ø§Ù„Ø¬ÙˆØ¯Ø© ÙˆØ§Ù„ØªÙ…ÙŠØ²', nextRole: 'Quality_Manager', nextStatus: 'Secretary_General' };
                    break;
                case 'Secretary_General':
                    details = { class: 'status-approved', text: 'ÙÙŠ Ø§Ù†ØªØ¸Ø§Ø± ØªÙˆÙ‚ÙŠØ¹ Ø£Ù…ÙŠÙ† Ø§Ù„Ø¬Ø§Ù…Ø¹Ø© (Ø§Ù„ØªÙˆÙ‚ÙŠØ¹ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ)', nextRole: 'Secretary_General', nextStatus: 'Approved_To_Print' };
                    break;
                case 'Approved_To_Print':
                    details = { class: 'status-printed', text: 'ØªÙ… Ø§Ù„Ø§Ø¹ØªÙ…Ø§Ø¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ - Ù„Ø¯Ù‰ Ø§Ù„Ù…Ø·Ø¨Ø¹Ø© Ø§Ù„Ø¢Ù†', nextRole: 'Print_Shop', nextStatus: 'Printed' };
                    break;
                case 'Printed':
                    details = { class: 'status-completed', text: 'ØªÙ… Ø§Ù„Ø·Ø¨Ø§Ø¹Ø© - ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªÙˆØ¬Ù‡ Ù„Ù„Ø§Ø³ØªÙ„Ø§Ù… âœ…', nextRole: 'College_Secretary', nextStatus: 'Pending' }; 
                    break;
                default:
                    details = { class: 'status-pending', text: 'Ù‚ÙŠØ¯ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±', nextRole: null, nextStatus: null };
                    break;
            }
            return details;
        }
        
        // **Ø¯Ø§Ù„Ø© Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„Ù…Ø³ØªÙ†Ø¯**
        function previewDocument(requestId) {
            const requests = loadRequests();
            const request = requests.find(req => req.id == requestId);
            
            if (!request) {
                showNotification('âŒ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø³ØªÙ†Ø¯', 'error');
                return;
            }
            
            if (!request.documentFile) {
                showNotification('âŒ Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ø³ØªÙ†Ø¯ Ù…Ø±ÙÙ‚ Ù„Ù‡Ø°Ø§ Ø§Ù„Ø·Ù„Ø¨', 'error');
                return;
            }
            
            currentPreviewDocument = request;
            document.getElementById('preview-title').textContent = `Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„Ù…Ø³ØªÙ†Ø¯ - Ø§Ù„Ø·Ù„Ø¨ Ø±Ù‚Ù… ${requestId}`;
            
            const previewContent = document.getElementById('preview-content');
            previewContent.innerHTML = '';
            
            if (request.documentFile.type.includes('pdf')) {
                // Ù…Ø¹Ø§ÙŠÙ†Ø© PDF
                const objectEl = document.createElement('object');
                objectEl.data = URL.createObjectURL(request.documentFile);
                objectEl.type = 'application/pdf';
                objectEl.style.width = '100%';
                objectEl.style.height = '500px';
                previewContent.appendChild(objectEl);
            } else if (request.documentFile.type.includes('word')) {
                // Ù…Ø¹Ø§ÙŠÙ†Ø© Word (Ù†Øµ ÙÙ‚Ø·)
                const reader = new FileReader();
                reader.onload = function(e) {
                    const text = e.target.result;
                    const pre = document.createElement('pre');
                    pre.style.whiteSpace = 'pre-wrap';
                    pre.style.fontFamily = 'Cairo, Arial, sans-serif';
                    pre.style.padding = '15px';
                    pre.style.backgroundColor = '#f8f9fa';
                    pre.style.borderRadius = '5px';
                    pre.style.maxHeight = '500px';
                    pre.style.overflow = 'auto';
                    pre.textContent = text;
                    previewContent.appendChild(pre);
                };
                reader.readAsText(request.documentFile);
            } else {
                previewContent.innerHTML = '<p style="text-align: center; color: #666; padding: 50px;">Ù„Ø§ ÙŠÙ…ÙƒÙ† Ù…Ø¹Ø§ÙŠÙ†Ø© Ù‡Ø°Ø§ Ø§Ù„Ù†ÙˆØ¹ Ù…Ù† Ø§Ù„Ù…Ù„ÙØ§Øª. ÙŠØ±Ø¬Ù‰ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„Ù Ù„Ø¹Ø±Ø¶Ù‡.</p>';
            }
            
            document.getElementById('preview-modal').style.display = 'flex';
        }
        
        // **Ø¯Ø§Ù„Ø© Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù…Ø¹Ø§ÙŠÙ†Ø©**
        function closePreview() {
            document.getElementById('preview-modal').style.display = 'none';
            currentPreviewDocument = null;
        }
        
        // **Ø¯Ø§Ù„Ø© ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø³ØªÙ†Ø¯ Ø§Ù„Ø­Ø§Ù„ÙŠ**
        function downloadCurrentDocument() {
            if (!currentPreviewDocument || !currentPreviewDocument.documentFile) {
                showNotification('âŒ Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ø³ØªÙ†Ø¯ Ù„Ù„ØªØ­Ù…ÙŠÙ„', 'error');
                return;
            }
            
            const link = document.createElement('a');
            link.href = URL.createObjectURL(currentPreviewDocument.documentFile);
            link.download = `Ø·Ù„Ø¨_${currentPreviewDocument.id}_${currentPreviewDocument.documentFile.name}`;
            link.click();
            showNotification('âœ… Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø³ØªÙ†Ø¯', 'success');
        }
        
        // **Ø¯Ø§Ù„Ø© Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„Ù…Ø³ØªÙ†Ø¯ Ø§Ù„Ø­Ø§Ù„ÙŠ**
        function printCurrentDocument() {
            if (!currentPreviewDocument || !currentPreviewDocument.documentFile) {
                showNotification('âŒ Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ø³ØªÙ†Ø¯ Ù„Ù„Ø·Ø¨Ø§Ø¹Ø©', 'error');
                return;
            }
            
            if (currentPreviewDocument.documentFile.type.includes('pdf')) {
                const pdfUrl = URL.createObjectURL(currentPreviewDocument.documentFile);
                const printWindow = window.open(pdfUrl);
                printWindow.onload = function() {
                    printWindow.print();
                };
            } else {
                showNotification('â„¹ï¸ ÙŠÙ…ÙƒÙ† Ø·Ø¨Ø§Ø¹Ø© Ù…Ù„ÙØ§Øª PDF ÙÙ‚Ø· Ù…Ø¨Ø§Ø´Ø±Ø© Ù…Ù† Ø§Ù„Ù…ØªØµÙØ­', 'info');
            }
        }
        
        // **Ø¯Ø§Ù„Ø© ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø³ØªÙ†Ø¯**
        function downloadDocument(requestId) {
            const requests = loadRequests();
            const request = requests.find(req => req.id == requestId);
            
            if (!request || !request.documentFile) {
                showNotification('âŒ Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ø³ØªÙ†Ø¯ Ù„Ù„ØªØ­Ù…ÙŠÙ„', 'error');
                return;
            }
            
            const link = document.createElement('a');
            link.href = URL.createObjectURL(request.documentFile);
            link.download = `Ø·Ù„Ø¨_${request.id}_${request.documentFile.name}`;
            link.click();
            showNotification('âœ… ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø³ØªÙ†Ø¯ Ø¨Ù†Ø¬Ø§Ø­', 'success');
        }
        
        // **Ø¯Ø§Ù„Ø© ÙØªØ­ Ù†Ø§ÙØ°Ø© Ø§Ø³ØªØ¨Ø¯Ø§Ù„ Ø§Ù„Ù…Ø³ØªÙ†Ø¯**
        function openReplaceModal(requestId) {
            currentRequestId = requestId;
            document.getElementById('replace-modal').style.display = 'flex';
            document.getElementById('new-document-file').value = '';
        }
        
        // **Ø¯Ø§Ù„Ø© Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø§Ø³ØªØ¨Ø¯Ø§Ù„**
        function cancelReplace() {
            document.getElementById('replace-modal').style.display = 'none';
            currentRequestId = null;
        }
        
        // **Ø¯Ø§Ù„Ø© ØªØ£ÙƒÙŠØ¯ Ø§Ø³ØªØ¨Ø¯Ø§Ù„ Ø§Ù„Ù…Ø³ØªÙ†Ø¯**
        function confirmReplace() {
            const newFile = document.getElementById('new-document-file').files[0];
            
            if (!newFile) {
                showNotification('ğŸš« ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ù…Ù„Ù Ø¬Ø¯ÙŠØ¯ Ù„Ù„Ø§Ø³ØªØ¨Ø¯Ø§Ù„', 'error');
                return;
            }
            
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ù†ÙˆØ¹ Ø§Ù„Ù…Ù„Ù
            const allowedTypes = ['application/pdf', 'application/vnd.openxmlformats-officedocument.wordprocessingml.document'];
            if (!allowedTypes.includes(newFile.type)) {
                showNotification('ğŸš« ÙŠØ±Ø¬Ù‰ Ø±ÙØ¹ Ù…Ù„Ù PDF Ø£Ùˆ Word ÙÙ‚Ø·', 'error');
                return;
            }
            
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø­Ø¬Ù… (10MB ÙƒØ­Ø¯ Ø£Ù‚ØµÙ‰)
            if (newFile.size > 10 * 1024 * 1024) {
                showNotification('ğŸš« Ø­Ø¬Ù… Ø§Ù„Ù…Ù„Ù ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø£Ù‚Ù„ Ù…Ù† 10MB', 'error');
                return;
            }
            
            let requests = loadRequests();
            const index = requests.findIndex(req => req.id == currentRequestId);
            
            if (index === -1) {
                showNotification('âŒ Ø®Ø·Ø£: Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„Ø·Ù„Ø¨', 'error');
                return;
            }
            
            // Ø­ÙØ¸ Ø§Ù„Ù…Ø³ØªÙ†Ø¯ Ø§Ù„Ù‚Ø¯ÙŠÙ… ÙÙŠ Ø§Ù„Ø³Ø¬Ù„
            const oldDocument = {
                path: requests[index].documentPath,
                fileName: requests[index].documentFile ? requests[index].documentFile.name : 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ',
                replacedAt: new Date().toLocaleString('ar-EG')
            };
            
            if (!requests[index].documentHistory) {
                requests[index].documentHistory = [];
            }
            requests[index].documentHistory.push(oldDocument);
            
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø³ØªÙ†Ø¯ Ø§Ù„Ø¬Ø¯ÙŠØ¯
            requests[index].documentFile = newFile;
            requests[index].documentPath = `docs/print_request_${currentRequestId}_v${requests[index].documentHistory.length + 1}_${Date.now()}.${newFile.type.includes('pdf') ? 'pdf' : 'docx'}`;
            
            saveRequests(requests);
            
            showNotification(`âœ… ØªÙ… Ø§Ø³ØªØ¨Ø¯Ø§Ù„ Ø§Ù„Ù…Ø³ØªÙ†Ø¯ Ø¨Ù†Ø¬Ø§Ø­ Ø·Ø¨Ù‚Ø§Ù‹ Ù„Ù„Ù…ÙˆØ§ØµÙØ© Ø§Ù„Ù‚ÙŠØ§Ø³ÙŠØ©\nØ§Ù„Ø¥ØµØ¯Ø§Ø± Ø§Ù„Ø¬Ø¯ÙŠØ¯: ${newFile.name}`, 'success');
            document.getElementById('replace-modal').style.display = 'none';
            renderRequests();
        }
        
        // **Ø¯Ø§Ù„Ø© Ø­Ø°Ù Ø§Ù„Ù…Ø³ØªÙ†Ø¯**
        function deleteDocument(requestId) {
            if (!confirm('âš ï¸ Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ø§Ù„Ù…Ø³ØªÙ†Ø¯ØŸ Ø³ÙŠØªÙ… ÙÙ‚Ø¯Ø§Ù† Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø±ØªØ¨Ø·Ø© Ø¨Ù‡.')) {
                return;
            }
            
            let requests = loadRequests();
            const index = requests.findIndex(req => req.id == requestId);
            
            if (index === -1) {
                showNotification('âŒ Ø®Ø·Ø£: Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„Ø·Ù„Ø¨', 'error');
                return;
            }
            
            // Ø­ÙØ¸ Ø§Ù„Ù…Ø³ØªÙ†Ø¯ Ø§Ù„Ù…Ø­Ø°ÙˆÙ ÙÙŠ Ø§Ù„Ø³Ø¬Ù„
            const deletedDocument = {
                path: requests[index].documentPath,
                fileName: requests[index].documentFile ? requests[index].documentFile.name : 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ',
                deletedAt: new Date().toLocaleString('ar-EG'),
                action: 'deleted'
            };
            
            if (!requests[index].documentHistory) {
                requests[index].documentHistory = [];
            }
            requests[index].documentHistory.push(deletedDocument);
            
            // Ø­Ø°Ù Ø§Ù„Ù…Ø³ØªÙ†Ø¯ Ø§Ù„Ø­Ø§Ù„ÙŠ
            requests[index].documentFile = null;
            requests[index].documentPath = null;
            
            saveRequests(requests);
            
            showNotification('âœ… ØªÙ… Ø­Ø°Ù Ø§Ù„Ù…Ø³ØªÙ†Ø¯ Ø¨Ù†Ø¬Ø§Ø­', 'success');
            renderRequests();
        }

        // **Ø¯Ø§Ù„Ø© Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµÙ„Ø§Ø­ÙŠØ© Ø£Ù…ÙŠÙ† Ø§Ù„ÙƒÙ„ÙŠØ©**
        function checkCollegeSecretaryPermission(reqCollege) {
            if (currentUserRole !== 'College_Secretary') {
                return true; // Ø§Ù„Ø£Ø¯ÙˆØ§Ø± Ø§Ù„Ø£Ø®Ø±Ù‰ Ù„ÙŠØ³ Ù„Ù‡Ø§ Ù‚ÙŠÙˆØ¯
            }
            
            return reqCollege === currentUserCollege;
        }

        // **Ø¯Ø§Ù„Ø© Ø¹Ø±Ø¶ Ø§Ù„Ø·Ù„Ø¨Ø§Øª**
        function renderRequests() {
            if (!currentUserRole) return; 
            
            const requests = loadRequests().reverse(); 
            renderFilteredRequests(requests);
        }

        function renderFilteredRequests(requests) {
            const listBody = document.getElementById('requests-list');
            listBody.innerHTML = '';
            
            if (requests.length === 0) {
                listBody.innerHTML = '<tr><td colspan="5" style="text-align: center;">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø·Ù„Ø¨Ø§Øª Ø·Ø¨Ø§Ø¹Ø© Ù…Ù‚Ø¯Ù…Ø© Ø­Ø§Ù„ÙŠÙ‹Ø§.</td></tr>';
                return;
            }

            requests.forEach(req => {
                const details = getStatusDetails(req.status);
                
                let rolesMatch = (currentUserRole === details.nextRole);
                let hasPermission = true;
                
                // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµÙ„Ø§Ø­ÙŠØ© Ø£Ù…ÙŠÙ† Ø§Ù„ÙƒÙ„ÙŠØ©
                if (currentUserRole === 'College_Secretary' && details.nextRole === 'College_Secretary') {
                    hasPermission = checkCollegeSecretaryPermission(req.college);
                    if (!hasPermission) {
                        rolesMatch = false;
                    }
                }
                
                // Ø§Ù„Ø³Ù…Ø§Ø­ Ù„Ù„Ù…Ø³Ø¤ÙˆÙ„ Ø§Ù„Ø¹Ø§Ù… Ø¨Ø§Ù„ØªÙˆÙ‚ÙŠØ¹ Ø¹Ù„Ù‰ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø·Ù„Ø¨Ø§Øª
                if (currentUserRole === 'Super_Admin') {
                    rolesMatch = true;
                    hasPermission = true;
                }
                
                let actionButton = '';
                
                // 1. ØªØ­Ø¯ÙŠØ¯ Ø²Ø± Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡ (Ø§Ù„ØªÙˆÙ‚ÙŠØ¹)
                if (rolesMatch && hasPermission) {
                    let buttonText = 'âœ… ØªÙˆÙ‚ÙŠØ¹ / Ù…ØªØ§Ø¨Ø¹Ø©';
                    if (details.nextStatus === 'Printed') {
                        buttonText = 'ØªÙ… Ø§Ù„Ø·Ø¨Ø§Ø¹Ø© (Ù…Ø³Ø¤ÙˆÙ„ Ø§Ù„Ù…Ø·Ø¨Ø¹Ø©)';
                    } else if (details.nextStatus === 'Pending' && req.status === 'Printed') {
                        buttonText = 'Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† (Ù„Ù„ØªØ¬Ø±Ø¨Ø©)';
                    }
                    actionButton = `<button onclick="simulateProcess(${req.id}, '${details.nextStatus}', '${details.nextRole}')">${buttonText}</button>`;
                } else if (rolesMatch && !hasPermission) {
                    // Ø²Ø± Ù…Ø¹Ø·Ù„ Ù…Ø¹ Ø±Ø³Ø§Ù„Ø© ØªÙˆØ¶ÙŠØ­ÙŠØ©
                    actionButton = `<button disabled title="Ù„Ø§ ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„ØªÙˆÙ‚ÙŠØ¹ Ø¹Ù„Ù‰ Ø·Ù„Ø¨Ø§Øª Ø§Ù„ÙƒÙ„ÙŠØ§Øª Ø§Ù„Ø£Ø®Ø±Ù‰">âŒ ØºÙŠØ± Ù…Ø³Ù…ÙˆØ­</button>`;
                }
                
                // 2. ØªØ­Ø¯ÙŠØ¯ Ø£Ø²Ø±Ø§Ø± Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³ØªÙ†Ø¯Ø§Øª (Ù„Ù€ DCO Ùˆ Super_Admin ÙÙ‚Ø·)
                let docManagementButtons = '';
                if ((currentUserRole === 'DCO' || currentUserRole === 'Super_Admin') && req.documentFile) {
                    docManagementButtons = `
                        <div class="doc-actions">
                            <button class="preview-btn" onclick="previewDocument(${req.id})">ğŸ‘ï¸ Ù…Ø¹Ø§ÙŠÙ†Ø©</button>
                            <button class="download-btn" onclick="downloadDocument(${req.id})">ğŸ“¥ ØªØ­Ù…ÙŠÙ„</button>
                            <button class="replace-btn" onclick="openReplaceModal(${req.id})">ğŸ”„ Ø§Ø³ØªØ¨Ø¯Ø§Ù„</button>
                            <button class="delete-btn" onclick="deleteDocument(${req.id})">ğŸ—‘ï¸ Ø­Ø°Ù</button>
                        </div>
                    `;
                } else if ((currentUserRole === 'DCO' || currentUserRole === 'Super_Admin') && !req.documentFile) {
                    docManagementButtons = `
                        <div class="doc-actions">
                            <button class="replace-btn" onclick="openReplaceModal(${req.id})">ğŸ“„ Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªÙ†Ø¯</button>
                        </div>
                    `;
                } else if (req.documentFile) {
                    // Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† ÙŠÙ…ÙƒÙ†Ù‡Ù… Ù…Ø¹Ø§ÙŠÙ†Ø© ÙˆØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø³ØªÙ†Ø¯Ø§Øª
                    docManagementButtons = `
                        <div class="doc-actions">
                            <button class="preview-btn" onclick="previewDocument(${req.id})">ğŸ‘ï¸ Ù…Ø¹Ø§ÙŠÙ†Ø©</button>
                            <button class="download-btn" onclick="downloadDocument(${req.id})">ğŸ“¥ ØªØ­Ù…ÙŠÙ„</button>
                        </div>
                    `;
                }

                // 3. Ø¯Ù…Ø¬ Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø®Ù„ÙŠØ©
                let actionCellContent = '';
                if (actionButton) {
                    actionCellContent = actionButton + (docManagementButtons ? `<br>${docManagementButtons}` : '');
                } else if (docManagementButtons) {
                    actionCellContent = docManagementButtons;
                } else {
                    const roleMap = {
                        'College_Secretary': 'Ø£Ù…ÙŠÙ† Ø§Ù„ÙƒÙ„ÙŠØ©',
                        'DCO': 'Ù…Ø³Ø¤ÙˆÙ„ Ø¶Ø¨Ø· Ø§Ù„ÙˆØ«Ø§Ø¦Ù‚',
                        'Quality_Manager': 'Ù…Ø¯ÙŠØ± Ø§Ù„Ø¬ÙˆØ¯Ø©',
                        'Secretary_General': 'Ø£Ù…ÙŠÙ† Ø§Ù„Ø¬Ø§Ù…Ø¹Ø©',
                        'Print_Shop': 'Ù…Ø³Ø¤ÙˆÙ„ Ø§Ù„Ù…Ø·Ø¨Ø¹Ø©',
                        'Dept_Official': 'Ù…Ø³Ø¤ÙˆÙ„ Ø§Ù„ÙƒÙ„ÙŠØ©/Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©'
                    };
                    const requiredRoleName = roleMap[details.nextRole] || 'Ù…Ø³Ø¤ÙˆÙ„ Ø¢Ø®Ø±';

                    actionCellContent = (req.status !== 'Printed') ? 
                        `<span style="color: #6c757d; font-size: 0.9em;">(ÙÙŠ Ø§Ù†ØªØ¸Ø§Ø± ØªÙˆÙ‚ÙŠØ¹ ${requiredRoleName})</span>`
                        : `<span style="color: #27ae60; font-weight: bold;">Ø§Ù„Ø·Ù„Ø¨ Ù…ÙƒØªÙ…Ù„</span>`;
                }

                const row = `
                    <tr>
                        <td>${req.id}</td>
                        <td>${req.college}</td>
                        <td>${req.date}</td>
                        <td class="${details.class}">${details.text}</td>
                        <td>${actionCellContent}</td>
                    </tr>
                `;
                listBody.innerHTML += row;
            });
        }

        // **Ø¯Ø§Ù„Ø© Ù…Ø­Ø§ÙƒØ§Ø© Ø§Ù„ØªÙˆÙ‚ÙŠØ¹**
        function simulateProcess(id, newStatus, requiredRole) {
            // Ø§Ù„Ø³Ù…Ø§Ø­ Ù„Ù„Ù…Ø³Ø¤ÙˆÙ„ Ø§Ù„Ø¹Ø§Ù… Ø¨Ø§Ù„ØªÙˆÙ‚ÙŠØ¹ Ø¨ØºØ¶ Ø§Ù„Ù†Ø¸Ø± Ø¹Ù† Ø§Ù„Ø¯ÙˆØ± Ø§Ù„Ù…Ø·Ù„ÙˆØ¨
            if (currentUserRole !== 'Super_Admin') {
                if (!currentUserRole || currentUserRole !== requiredRole) {
                    const roleMap = {
                        'College_Secretary': 'Ø£Ù…ÙŠÙ† Ø§Ù„ÙƒÙ„ÙŠØ©',
                        'DCO': 'Ù…Ø³Ø¤ÙˆÙ„ Ø¶Ø¨Ø· Ø§Ù„ÙˆØ«Ø§Ø¦Ù‚',
                        'Quality_Manager': 'Ù…Ø¯ÙŠØ± Ø§Ù„Ø¬ÙˆØ¯Ø©',
                        'Secretary_General': 'Ø£Ù…ÙŠÙ† Ø§Ù„Ø¬Ø§Ù…Ø¹Ø©',
                        'Print_Shop': 'Ù…Ø³Ø¤ÙˆÙ„ Ø§Ù„Ù…Ø·Ø¨Ø¹Ø©',
                        'Dept_Official': 'Ù…Ø³Ø¤ÙˆÙ„ Ø§Ù„ÙƒÙ„ÙŠØ©/Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©'
                    };
                    const requiredRoleName = roleMap[requiredRole] || 'Ø¯ÙˆØ± ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ';

                    showNotification(`âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ©: Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø¥ØªÙ…Ø§Ù… Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡. ÙŠØ±Ø¬Ù‰ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ø­Ø³Ø§Ø¨: ${requiredRoleName} (${requiredRole})`, 'error');
                    return;
                }

                // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµÙ„Ø§Ø­ÙŠØ© Ø£Ù…ÙŠÙ† Ø§Ù„ÙƒÙ„ÙŠØ©
                let requests = loadRequests();
                const request = requests.find(req => req.id == id);
                
                if (currentUserRole === 'College_Secretary' && request.college !== currentUserCollege) {
                    showNotification(`âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ©: Ù„Ø§ ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„ØªÙˆÙ‚ÙŠØ¹ Ø¹Ù„Ù‰ Ø·Ù„Ø¨Ø§Øª Ø§Ù„ÙƒÙ„ÙŠØ§Øª Ø§Ù„Ø£Ø®Ø±Ù‰. ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„ØªÙˆÙ‚ÙŠØ¹ ÙÙ‚Ø· Ø¹Ù„Ù‰ Ø·Ù„Ø¨Ø§Øª ÙƒÙ„ÙŠØªÙƒ (${currentUserCollege}).`, 'error');
                    return;
                }
            }

            let requests = loadRequests();
            const index = requests.findIndex(req => req.id == id);
            if (index === -1) return;

            let message;
            requests[index].status = newStatus;
            
            switch(newStatus) {
                case 'DCO_Review':
                    message = `ØªÙ… ØªÙˆÙ‚ÙŠØ¹ Ø£Ù…ÙŠÙ† Ø§Ù„ÙƒÙ„ÙŠØ© Ø¨Ù†Ø¬Ø§Ø­. Ø§Ù„Ø·Ù„Ø¨ Ø§Ù„Ø¢Ù† Ù„Ø¯Ù‰ Ù…Ø³Ø¤ÙˆÙ„ Ø¶Ø¨Ø· Ø§Ù„ÙˆØ«Ø§Ø¦Ù‚.`;
                    break;
                case 'Quality_Manager':
                    message = `Ù…Ø³Ø¤ÙˆÙ„ Ø¶Ø¨Ø· Ø§Ù„ÙˆØ«Ø§Ø¦Ù‚ Ù‚Ø§Ù… Ø¨Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ Ùˆ Ø§Ù„ØªÙˆÙ‚ÙŠØ¹. Ø§Ù„Ø·Ù„Ø¨ Ø§Ù„Ø¢Ù† Ù„Ø¯Ù‰ Ù…Ø¯ÙŠØ± Ø§Ù„Ø¬ÙˆØ¯Ø©.`;
                    break;
                case 'Secretary_General':
                    message = `Ù…Ø¯ÙŠØ± Ø§Ù„Ø¬ÙˆØ¯Ø© ÙˆÙ‚Ø¹ Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ§Ù‹. Ø§Ù„Ø·Ù„Ø¨ Ø§Ù„Ø¢Ù† Ù„Ø¯Ù‰ Ø£Ù…ÙŠÙ† Ø§Ù„Ø¬Ø§Ù…Ø¹Ø©.`;
                    break;
                case 'Approved_To_Print':
                    message = `ØªÙˆÙ‚ÙŠØ¹ Ø£Ù…ÙŠÙ† Ø§Ù„Ø¬Ø§Ù…Ø¹Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ. Ø§Ù„Ø·Ù„Ø¨ Ø§Ù„Ø¢Ù† Ù…Ø±Ø³Ù„ Ù„Ù„Ù…Ø·Ø¨Ø¹Ø© Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ§Ù‹.`;
                    break;
                case 'Printed':
                    message = `Ø§Ù„Ù…Ø·Ø¨Ø¹Ø© Ø·Ø¨Ø¹Øª Ø§Ù„Ø·Ù„Ø¨ ÙˆØ£ÙƒØ¯Øª Ø§Ù„Ø¥Ù†Ø¬Ø§Ø². ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø¥Ø´Ø¹Ø§Ø± Ù„Ù„Ù…Ø±Ø³Ù„ Ù„Ù„Ø§Ø³ØªÙ„Ø§Ù….`;
                    break;
                case 'Pending':
                    message = `ØªÙ…Øª Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø­Ø§Ù„Ø© Ø§Ù„Ø·Ù„Ø¨ Ø¥Ù„Ù‰ Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©.`;
                    break;
                default:
                    message = `ØªÙ… ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ø·Ù„Ø¨.`;
            }
            
            saveRequests(requests);
            showNotification(`Ø§Ù„Ø·Ù„Ø¨ Ø±Ù‚Ù… ${id}:\n ØªÙ… Ø§Ù„ØªÙˆÙ‚ÙŠØ¹ Ø¨ÙˆØ§Ø³Ø·Ø© ${currentUserName || 'Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø­Ø§Ù„ÙŠ'}.\n Ù…Ø­Ø§ÙƒØ§Ø©: ${message}`, 'success');
            renderRequests();
            updateStatistics();
        }

        // Ù…Ø¹Ø§Ù„Ø¬Ø© Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„ØªÙ‚Ø¯ÙŠÙ…
        document.getElementById('print-request-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            if (!currentUserRole) {
                 showNotification('ÙŠØ±Ø¬Ù‰ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹ Ù„Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨ Ø·Ø¨Ø§Ø¹Ø© Ø¬Ø¯ÙŠØ¯.', 'error');
                 return;
            }
            
            if (currentUserRole !== 'Dept_Official') {
                showNotification('ğŸš« Ù„Ø§ ÙŠÙ…ÙƒÙ†Ùƒ Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨Ø§Øª Ø·Ø¨Ø§Ø¹Ø© Ø¨Ù‡Ø°Ø§ Ø§Ù„Ø¯ÙˆØ±. ÙŠØ±Ø¬Ù‰ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø¯ÙˆØ± Ù…Ø³Ø¤ÙˆÙ„ Ø§Ù„ÙƒÙ„ÙŠØ©/Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© (Dept_Official).', 'error');
                return;
            }

            const collegeName = document.getElementById('college-name').value;
            const documentFile = document.getElementById('document-file').files[0];
            
            if (!documentFile) {
                showNotification('ğŸš« ÙŠØ±Ø¬Ù‰ Ø¥Ø±ÙØ§Ù‚ Ù…Ø³ØªÙ†Ø¯ Ù„Ù„Ø·Ø¨Ø§Ø¹Ø©', 'error');
                return;
            }
            
            let requests = loadRequests();
            const newId = (requests.length > 0) ? Math.max(...requests.map(r => r.id)) + 1 : 1001;
            const newDate = new Date().toLocaleDateString('ar-EG', { day: 'numeric', month: 'short', year: 'numeric' });

            const newRequest = {
                id: newId,
                requester: document.getElementById('requester-name').value,
                college: collegeName,
                whatsapp: document.getElementById('whatsapp-number').value,
                date: newDate,
                status: 'Pending',
                documentPath: `docs/print_request_${newId}_${Date.now()}.${documentFile.type.includes('pdf') ? 'pdf' : 'docx'}`,
                documentFile: documentFile,
                documentHistory: []
            };

            requests.push(newRequest);
            saveRequests(requests);

            showNotification(`âœ… ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨ Ø§Ù„Ø·Ø¨Ø§Ø¹Ø© Ø¨Ù†Ø¬Ø§Ø­! Ø±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨: ${newId}.\nØ³ÙŠØ¨Ø¯Ø£ Ø§Ù„Ø¢Ù† Ù…Ø³Ø§Ø± Ø§Ù„Ø§Ø¹ØªÙ…Ø§Ø¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ.`, 'success');
            this.reset(); 
            document.getElementById('requester-name').value = "Ø£Ø­Ù…Ø¯ Ù…Ø­Ù…Ø¯";
            document.getElementById('college-name').value = "Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¬ÙˆØ¯Ø© ÙˆØ§Ù„ØªÙ…ÙŠØ²";
            document.getElementById('whatsapp-number').value = "01xxxxxxxxx";
            renderRequests(); 
            updateStatistics();
        });

        // Ø¯Ø§Ù„Ø© ØªØ²Ø§Ù…Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙŠØ¯ÙˆÙŠØ©
        function synchronizeData() {
            const syncTimeElement = document.getElementById('last-sync-time');
            const currentTime = new Date().toLocaleTimeString('ar-EG', { hour: '2-digit', minute: '2-digit', second: '2-digit' });
            
            console.log("ØªØ²Ø§Ù…Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ø¯Ø£...");
            document.getElementById('sync-button').disabled = true;
            document.getElementById('sync-button').textContent = 'Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ²Ø§Ù…Ù†...';

            setTimeout(() => {
                syncTimeElement.textContent = currentTime;
                showNotification(`ğŸ”„ ØªÙ… ØªØ²Ø§Ù…Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­ ÙÙŠ: ${currentTime}.`, 'info');
                document.getElementById('sync-button').disabled = false;
                document.getElementById('sync-button').textContent = 'ğŸ”„ ØªØ²Ø§Ù…Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙŠØ¯ÙˆÙŠÙ‹Ø§';
                console.log("ØªØ²Ø§Ù…Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù†ØªÙ‡Ù‰.");
            }, 1000);
        }

        // **Ù†Ø¸Ø§Ù… Ø§Ù„Ù…Ø±ÙÙ‚Ø§Øª Ø§Ù„Ù…Ø­Ø³Ù†**
        function handleFileUpload(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ù†ÙˆØ¹ Ø§Ù„Ù…Ù„Ù
            const allowedTypes = ['application/pdf', 'application/vnd.openxmlformats-officedocument.wordprocessingml.document'];
            if (!allowedTypes.includes(file.type)) {
                showNotification('ÙŠØ±Ø¬Ù‰ Ø±ÙØ¹ Ù…Ù„Ù PDF Ø£Ùˆ Word ÙÙ‚Ø·', 'error');
                event.target.value = '';
                return;
            }
            
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø­Ø¬Ù… (10MB ÙƒØ­Ø¯ Ø£Ù‚ØµÙ‰)
            if (file.size > 10 * 1024 * 1024) {
                showNotification('Ø­Ø¬Ù… Ø§Ù„Ù…Ù„Ù ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø£Ù‚Ù„ Ù…Ù† 10MB', 'error');
                event.target.value = '';
                return;
            }
            
            showNotification(`âœ… ØªÙ… Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…Ù„Ù: ${file.name}`, 'success');
        }

        // **Ù†Ø¸Ø§Ù… Ø§Ù„Ø¨Ø­Ø« ÙˆØ§Ù„ØªØµÙÙŠØ©**
        function setupFilters() {
            const searchInput = document.getElementById('search-requests');
            const statusFilter = document.getElementById('status-filter');
            
            searchInput.addEventListener('input', filterRequests);
            statusFilter.addEventListener('change', filterRequests);
        }

        function filterRequests() {
            const searchTerm = document.getElementById('search-requests').value.toLowerCase();
            const statusFilter = document.getElementById('status-filter').value;
            
            const requests = loadRequests();
            const filteredRequests = requests.filter(req => {
                const matchesSearch = req.id.toString().includes(searchTerm) || 
                            req.college.toLowerCase().includes(searchTerm) ||
                            req.requester.toLowerCase().includes(searchTerm);
                
                const matchesStatus = statusFilter === '' || req.status === statusFilter;
                
                return matchesSearch && matchesStatus;
            });
            
            renderFilteredRequests(filteredRequests.reverse());
        }

        function resetFilters() {
            document.getElementById('search-requests').value = '';
            document.getElementById('status-filter').value = '';
            renderRequests();
        }

        // **Ù†Ø¸Ø§Ù… Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª**
        function updateStatistics() {
            const requests = loadRequests();
            const total = requests.length;
            const pending = requests.filter(req => 
                req.status !== 'Printed' && req.status !== 'Approved_To_Print'
            ).length;
            const completed = requests.filter(req => 
                req.status === 'Printed'
            ).length;
            const inReview = requests.filter(req => 
                req.status === 'DCO_Review' || req.status === 'Quality_Manager' || req.status === 'Secretary_General'
            ).length;
            
            document.getElementById('total-requests').textContent = total;
            document.getElementById('pending-requests').textContent = pending;
            document.getElementById('completed-requests').textContent = completed;
            document.getElementById('review-requests').textContent = inReview;
        }

        // **Ù†Ø¸Ø§Ù… Ø§Ù„Ù†Ø³Ø® Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠ**
        function exportData() {
            const requests = loadRequests();
            
            // ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ù…Ù„ÙØ§Øª Ø¥Ù„Ù‰ base64 Ù„Ù„Ø­ÙØ¸
            const requestsWithFiles = requests.map(req => {
                const requestCopy = {...req};
                if (requestCopy.documentFile) {
                    // Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø­ÙØ¸ ÙƒØ§Ø¦Ù† File Ù…Ø¨Ø§Ø´Ø±Ø© ÙÙŠ JSON
                    // ÙÙŠ Ù†Ø¸Ø§Ù… Ø­Ù‚ÙŠÙ‚ÙŠØŒ Ø³ÙŠØªÙ… Ø±ÙØ¹ Ø§Ù„Ù…Ù„ÙØ§Øª Ø¥Ù„Ù‰ Ø§Ù„Ø®Ø§Ø¯Ù…
                    requestCopy.documentFile = {
                        name: requestCopy.documentFile.name,
                        type: requestCopy.documentFile.type,
                        size: requestCopy.documentFile.size,
                        // ÙÙŠ Ù†Ø¸Ø§Ù… Ø­Ù‚ÙŠÙ‚ÙŠØŒ Ø³ÙŠØªÙ… Ø­ÙØ¸ Ø±Ø§Ø¨Ø· Ø§Ù„Ù…Ù„Ù Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                    };
                }
                return requestCopy;
            });
            
            const dataStr = JSON.stringify(requestsWithFiles, null, 2);
            const dataBlob = new Blob([dataStr], { type: 'application/json' });
            
            const link = document.createElement('a');
            link.href = URL.createObjectURL(dataBlob);
            link.download = `backup_requests_${new Date().toISOString().split('T')[0]}.json`;
            link.click();
            showNotification('ØªÙ… ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­', 'success');
        }

        function importData(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const requests = JSON.parse(e.target.result);
                    if (Array.isArray(requests)) {
                        localStorage.setItem('printRequests2', JSON.stringify(requests));
                        showNotification('ØªÙ… Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­', 'success');
                        renderRequests();
                        updateStatistics();
                    }
                } catch (error) {
                    showNotification('Ø®Ø·Ø£ ÙÙŠ ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ù…Ù„Ù', 'error');
                }
            };
            reader.readAsText(file);
            event.target.value = ''; // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø­Ù‚Ù„ Ø§Ù„Ø±ÙØ¹
        }

        // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØµÙØ­Ø© Ø¹Ù†Ø¯ Ø§Ù„ØªØ­Ù…ÙŠÙ„
        document.addEventListener('DOMContentLoaded', () => {
            initializeVisitorCounter();
            initializeRequests(); 
            
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¬Ù„Ø³Ø© Ø§Ù„Ù†Ø´Ø·Ø©
            const activeUser = checkSession();
            if (activeUser) {
                currentUserRole = activeUser.role;
                currentUserName = activeUser.name;
                document.getElementById('login-screen').style.display = 'none';
                document.getElementById('main-content').style.display = 'block';
                
                // ØªØ­Ø¯ÙŠØ« Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙÙŠ Ø§Ù„Ø±Ø£Ø³
                updateUserDisplay(activeUser);
                
                // Ø¥Ø¸Ù‡Ø§Ø± ØªØ­Ø°ÙŠØ± Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ© Ù„Ø£Ù…Ù†Ø§Ø¡ Ø§Ù„ÙƒÙ„ÙŠØ§Øª
                if (activeUser.role === 'College_Secretary') {
                    document.getElementById('college-sec-warning').style.display = 'block';
                    document.getElementById('user-college-name').textContent = currentUserCollege;
                }
                
                renderRequests();
                updateStatistics();
                setupFilters();
                autoLogout();
            } else {
                currentUserRole = null; 
                currentUserName = null;
                currentUserCollege = null;
                const mainContent = document.getElementById('main-content');
                const loginScreen = document.getElementById('login-screen');
                loginScreen.style.display = 'flex';
                mainContent.style.display = 'none';
            }

            const currentTime = new Date().toLocaleTimeString('ar-EG', { hour: '2-digit', minute: '2-digit' });
            document.getElementById('last-sync-time').textContent = currentTime;
        });
    </script>
</body>
</html>
